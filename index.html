<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Recast Partner Program – Branded Preview</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <script src="https://unpkg.com/lucide@latest"></script>
  </head>
  <body class="bg-[#f9fafb] text-[#111827] font-['Inter',sans-serif] min-h-screen antialiased">
    <header class="relative overflow-hidden">
      <div aria-hidden="true" class="pointer-events-none absolute inset-0 blur-3xl"
           style="background:
             radial-gradient(60% 60% at 20% 10%, rgba(37,99,235,0.18) 0%, transparent 70%),
             radial-gradient(60% 60% at 80% 0%, rgba(37,99,235,0.18) 0%, transparent 70%),
             radial-gradient(80% 80% at 50% 90%, rgba(37,99,235,0.1) 0%, transparent 70%)">
      </div>
      <div class="relative mx-auto max-w-7xl px-6 lg:px-12 pt-10 pb-8">
        <div class="flex items-center justify-between">
          <div class="inline-flex items-center gap-2 rounded-full border border-[#E2E8F0] bg-white px-3 py-1 text-xs text-gray-600">
            <span class="inline-block h-1.5 w-1.5 rounded-full bg-[#2563eb]" aria-hidden="true"></span>
            <span class="sr-only">Recast Partner Program</span>
          </div>
        </div>
        <h1 class="mt-4 text-3xl font-semibold leading-tight sm:text-4xl">
          <span class="text-transparent bg-clip-text"
                style="background-image: linear-gradient(90deg, #2563eb, #1d4ed8);">Recast Partner Program</span>
        </h1>
        <p class="mt-2 max-w-3xl text-gray-700 leading-relaxed">
          We put <span class="text-[#2563eb] font-semibold">partnership</span> at the center of how we go to market.
        </p>
      </div>
    </header>
    <main class="relative mx-auto max-w-7xl px-6 lg:px-12 pb-20">
      <div id="app"></div>
    </main>
    <script>
      const STATE = {
        partnerType: 'Program Overview',
        commitment: 'Annual',
        dealType: 'Net New',
        newPartner: false,
        activeTab: 'overview',
        showBusinessPlanModal: false,
        showEvaluationModal: false,
        showPartnerEventsModal: false,
        showCsvModal: false,
        showLeadsGuideModal: false,
        showPartnersHelpModal: false,
        showInternalROEPopout: false,
        showPartnerCommPopout: false,
        showDealRegModal: false,
        activeStep: 0,
        tier: 'tier1',
        activeTier: 'tier1',
        roeView: 'partner',
        defaultTierByType: { Registered:'tier3', 'Value/Preferred':'tier2', 'Strategic/Premier':'tier1' },
        partnerTierMeta: {
          'Registered': {
            defaultTier: 'tier3',
            marginCap: '5%',
            coSellEligible: false,
            fullCycleEligible: false,
          },
          'Value/Preferred': {
            defaultTier: 'tier2',
            marginCap: '15%',
            coSellEligible: true,
            fullCycleEligible: true,
          },
          'Strategic/Premier': {
            defaultTier: 'tier1',
            marginCap: '25%',
            coSellEligible: true,
            fullCycleEligible: true,
          },
        },
        showMspOption: false,
        simpleROE: {
          Registered: {
            summary: "You can refer and transact. Margin capped at 5% for transactional or referral sales only.",
            sourcing: [
              {label:"Partner Sourced", value:"You found the opp + registered it → Up to 5% if approved."},
              {label:"Transactional/Referral", value:"Intro or PO only → Referral margin."}
            ],
            bands: [
              {band:"Tier 3 – Transactional", when:["Intro only or PO processing"], rule:"Default for LAR/Referral"}
            ],
            renewals:[
              "Renewal margin is discretionary, capped at 5%, and applies only if the LAR manages the renewal process.",
            ],
            roePrinciples: [
              {principle:"Deal Registration", description:"Required only when Recast requests it for transactional tracking.", intent:"Maintain visibility into reseller-led renewals and SKUs."},
              {principle:"Partner of Record", description:"Applies on approved transactions only; expires automatically at renewal unless partner remains active.", intent:"Simplify transactional flow; no lifetime PoR."},
              {principle:"Sales Collaboration", description:"Optional; Recast leads the sale, LAR supports quote and PO process.", intent:"Maintain message control and accuracy."},
              {principle:"Renewal Ownership", description:"Renewal margin is discretionary, capped at 5%, and applies only if the LAR manages the renewal process.", intent:"Protect margin integrity and ensure customer experience consistency."},
            ],
            marginBands: [
              {band:"Tier 3 – Transactional / Referral", criteria:"Partner identifies or processes transaction. Recast leads sales cycle and closes opportunity.", eligible:"Registered (LAR/Referral)", margin:"5% (Discretionary)", example:"LAR adds Recast SKU to renewal with minimal engagement."},
            ],
            csv: {
              blurb:"Upload event or campaign lists for fast routing. Influence ≠ margin.",
              required:["Partner Name","Campaign Name/ID","Account Name (and Domain)","First Name","Last Name","Email","Country","Source Type","Attribution Intent","Requested PoR (Y/N)"],
              flow:[
                "Create/Update Campaign Members; de-dupe by email; match Account by Domain/Name.",
                "Stamp: Lead Source=Partner Event; Sourcing Partner; Attribution (Primary/Influence).",
                "Option: 'Create Deal Registration' → PQL → Channel approval in 2 business days."
              ]
            }
          },
          'Value/Preferred': {
            summary:"You co-sell with us; consistent activity earns Tier 2. Own full cycle → Tier 1.",
            sourcing: [
              {label:"Partner Sourced", value:"You found the opp + registered it + helped close → Full margin when you drive the sale."},
              {label:"Recast Sourced (Co-Sell)", value:"We brought the lead; you help sell → Shared margin."},
              {label:"Transactional/Referral", value:"Intro or PO only → Referral margin."}
            ],
            bands:[
              {band:"Tier 1 – Full-Cycle", when:["Sourced + registered","Owns qual→close with light Recast support"], rule:"Full margin"},
              {band:"Tier 2 – Co-Sell", when:["Shared discovery/demo/pricing; active MAP"], rule:"Shared margin"}
            ],
            renewals:["PoR retains renewal with activity compliance; else may be reassigned."],
            csv: {
              blurb:"Upload event or campaign lists for fast routing. Influence ≠ margin.",
              required:["Partner Name","Campaign Name/ID","Account Name (and Domain)","First Name","Last Name","Email","Country","Source Type","Attribution Intent","Requested PoR (Y/N)"],
              flow:[
                "Create/Update Campaign Members; de-dupe by email; match Account by Domain/Name.",
                "Stamp: Lead Source=Partner Event; Sourcing Partner; Attribution (Primary/Influence).",
                "Option: 'Create Deal Registration' → PQL → Channel approval in 2 business days."
              ]
            }
          },
          'Strategic/Premier': {
            summary:"Strategic partner. Default expectation is Tier 1 unless co-sell is requested.",
            sourcing: [
              {label:"Partner Sourced", value:"You found the opp + registered it + helped close → Full margin when you drive the sale."},
              {label:"Recast Sourced (Co-Sell)", value:"We brought the lead; you help sell → Shared margin."},
              {label:"Transactional/Referral", value:"Intro or PO only → Referral margin."}
            ],
            bands:[
              {band:"Tier 1 – Full-Cycle", when:["Sourced + end-to-end ownership"], rule:"Full margin"},
              {band:"Tier 2 – Co-Sell", when:["Recast Sourced or heavier presales help"], rule:"Shared margin"}
            ],
            renewals:["PoR renewal protection with activity; expansions follow Tiers."],
            csv: {
              blurb:"Upload event or campaign lists for fast routing. Influence ≠ margin.",
              required:["Partner Name","Campaign Name/ID","Account Name (and Domain)","First Name","Last Name","Email","Country","Source Type","Attribution Intent","Requested PoR (Y/N)"],
              flow:[
                "Create/Update Campaign Members; de-dupe by email; match Account by Domain/Name.",
                "Stamp: Lead Source=Partner Event; Sourcing Partner; Attribution (Primary/Influence).",
                "Option: 'Create Deal Registration' → PQL → Channel approval in 2 business days."
              ]
            }
          },
          MSP: {
            summary:"Managed service delivery; monthly economics; PoR protections per MSP ROE.",
            sourcing:[{label:"MSP Motion", value:"You package Recast in services; co-sell on net-new logos."}],
            bands:[
              {band:"Tier 1", when:["MSP drives sale and delivery"], rule:"Programmed in MSP price book"},
              {band:"Tier 2", when:["Co-sell with Recast SE/AE"], rule:"Shared margin"}
            ],
            renewals:["Incumbent MSP retains renewal if active in lifecycle reviews."],
            roePrinciples: [
              {principle:"Deal Registration", description:"Mandatory for all partner-led opportunities.", intent:"Protect partner investment."},
              {principle:"Partner of Record", description:"Approved PoR retains lifecycle rights with active engagement.", intent:"Encourage long-term loyalty."},
            ],
            marginBands: [
              {band:"Tier 1 – MSP Driven", criteria:"MSP drives sale and delivery.", eligible:"MSP", margin:"25%", example:"MSP packages and sells Recast in managed services."},
              {band:"Tier 2 – Co-Sell", criteria:"Co-sell with Recast.", eligible:"MSP", margin:"15%", example:"Joint sale with Recast support."},
            ],
            csv: {
              blurb:"Upload event or campaign lists for fast routing. Influence ≠ margin. Emphasize multitenant lists.",
              required:["Partner Name","Campaign Name/ID","Account Name (and Domain)","First Name","Last Name","Email","Country","Source Type","Attribution Intent","Requested PoR (Y/N)"],
              flow:[
                "Create/Update Campaign Members; de-dupe by email; match Account by Domain/Name.",
                "Stamp: Lead Source=Partner Event; Sourcing Partner; Attribution (Primary/Influence).",
                "Option: 'Create Deal Registration' → PQL → Channel approval in 2 business days."
              ]
            }
          }
        },
        exampleACV: 100000,
        servicesMultiplier: 6,
        salesCycle: {
          stages: {
            PQL: {
              label: "PQL",
              description: "Partner Qualified Lead registered in portal. Recast approval is required to assign Partner of Record.",
              entryCriteria: ["Partner identifies lead", "Lead submitted in Partner Portal"],
              exitCriteria: ["Recast approves or declines within SLA", "Partner of Record set in CRM"],
              deliverables: ["Registration form (company, domain, contacts, use case)", "Approval notification"],
            },
            Identification: {
              label: "Identification (10%)",
              description: "Initial contact made; meeting confirmed; problem identified.",
              entryCriteria: ["Approved lead", "Intro outreach completed"],
              exitCriteria: ["Discovery meeting held", "Clear problem statement"],
              deliverables: ["Discovery notes", "Next-step email / agenda"],
            },
            Qualification: {
              label: "Qualification (25%)",
              description: "Pain and decision process validated; budget signal present; technical feasibility confirmed.",
              entryCriteria: ["Engaged prospect", "Business + technical discovery"],
              exitCriteria: ["Budget/timeline/authority captured", "Technical viability confirmed"],
              deliverables: ["MEDDICC summary", "Qualified Opportunity in CRM"],
            },
            Development: {
              label: "Development (50%)",
              description: "Solutioning and validation; business case and compelling event linked to value.",
              entryCriteria: ["Technical work started", "Solution fit agreed"],
              exitCriteria: ["Technical Win achieved", "Budget allocated"],
              deliverables: ["Technical validation checklist", "Mutual Action Plan (MAP)", "High-level architecture / scope"],
            },
            Proposal: {
              label: "Proposal (75%)",
              description: "Commercial alignment; quote/SOW delivered; legal/security reviews in progress.",
              entryCriteria: ["Budget identified", "Solution design accepted"],
              exitCriteria: ["Budget approval in progress", "Security/Legal submitted"],
              deliverables: ["Final quote or SOW", "Security questionnaire / DPA (if required)"],
            },
            Closing: {
              label: "Closing (90%)",
              description: "Signature or PO routing; go-live plan established.",
              entryCriteria: ["Commercial terms finalized", "Redlines near completion"],
              exitCriteria: ["Signature/PO received", "Launch date confirmed"],
              deliverables: ["Executed order form/PO", "Launch plan"],
            },
            ClosedWon: {
              label: "Closed Won",
              description: "Provisioning and fulfillment completed; CS intro scheduled.",
              entryCriteria: ["Executed paperwork"],
              exitCriteria: ["Software/license delivered", "CS kickoff scheduled"],
              deliverables: ["Fulfillment confirmation", "Handoff note to CS"],
            },
            Onboarding: {
              label: "Onboarding",
              description: "Kickoff → Implementation → UAT → Launch → Enablement; drive time-to-value and adoption.",
              entryCriteria: ["Closed-won handoff"],
              exitCriteria: ["Go-live achieved", "Enablement milestones completed"],
              deliverables: ["Kickoff deck", "Implementation checklist", "UAT sign-off", "Training/Certification path"],
            },
          },
          tierMeta: {
            tier1: {
              name: "Tier 1 – Full-Cycle Ownership",
              summary: "Partner leads end-to-end (lead → close). Recast provides SMEs as needed.",
              margin: "25%",
              color: "bg-green-100 text-green-800",
            },
            tier2: {
              name: "Tier 2 – Joint Engagement",
              summary: "Co-sell motion. Partner drives top/mid-funnel; Recast supports validation and close.",
              margin: "15%",
              color: "bg-amber-100 text-amber-800",
            },
            tier3: {
              name: "Tier 3 – Transactional / Referral",
              summary: "Partner sources or influences; Recast runs the sale.",
              margin: "5% (discretionary)",
              color: "bg-slate-200 text-slate-800",
            },
          },
          tiers: {
            tier1: {
              PQL: { primaryOwner: "Partner AE", support: ["Recast Channel Manager"], accountable: "Recast Channel Manager" },
              Identification: { primaryOwner: "Partner AE", support: ["Recast AE"], accountable: "Partner Sales Lead" },
              Qualification: { primaryOwner: "Partner AE", support: ["Partner SE"], accountable: "Partner Sales Lead" },
              Development: { primaryOwner: "Partner SE", support: ["Recast SE (as-needed)", "Partner AE"], accountable: "Partner SE Lead" },
              Proposal: { primaryOwner: "Partner AE", support: ["Partner SE", "Recast AE (pricing review)", "Recast Legal/Security (as-needed)"], accountable: "Partner Sales Lead" },
              Closing: { primaryOwner: "Partner AE", support: ["Recast AE", "Channel Ops"], accountable: "Partner Sales Lead" },
              ClosedWon: { primaryOwner: "Partner AE", support: ["Recast AE", "Recast CS"], accountable: "Recast Sales Leader" },
              Onboarding: { primaryOwner: "Partner Services", support: ["Recast CS", "Partner PM"], accountable: "Recast CS Leader" },
            },
            tier2: {
              PQL: { primaryOwner: "Partner AE", support: ["Recast Channel Manager"], accountable: "Recast Channel Manager" },
              Identification: { primaryOwner: "Partner AE", support: ["Recast AE"], accountable: "Recast AE" },
              Qualification: { primaryOwner: "Partner AE", support: ["Recast SE"], accountable: "Recast AE" },
              Development: { primaryOwner: "Recast SE", support: ["Partner SE", "Partner AE"], accountable: "Recast SE Lead" },
              Proposal: { primaryOwner: "Recast AE", support: ["Partner AE", "Recast Legal/Security"], accountable: "Recast Sales Leader" },
              Closing: { primaryOwner: "Recast AE", support: ["Partner AE", "Channel Ops"], accountable: "Recast Sales Leader" },
              ClosedWon: { primaryOwner: "Recast AE", support: ["Recast CS", "Partner AE"], accountable: "Recast Sales Leader" },
              Onboarding: { primaryOwner: "Recast CS", support: ["Partner Services"], accountable: "Recast CS Leader" },
            },
            tier3: {
              PQL: { primaryOwner: "Recast AE / Channel Manager", support: ["Partner (Referral / LAR)"], accountable: "Recast Channel Manager" },
              Identification: { primaryOwner: "Recast AE", support: ["Partner (Intro only)"], accountable: "Recast AE" },
              Qualification: { primaryOwner: "Recast AE", support: ["Recast SE"], accountable: "Recast AE" },
              Development: { primaryOwner: "Recast SE", support: ["Recast AE"], accountable: "Recast SE Lead" },
              Proposal: { primaryOwner: "Recast AE", support: ["Legal/Security", "Finance"], accountable: "Recast Sales Leader" },
              Closing: { primaryOwner: "Recast AE", support: ["Channel Ops"], accountable: "Recast Sales Leader" },
              ClosedWon: { primaryOwner: "Recast AE", support: ["CS"], accountable: "Recast Sales Leader" },
              Onboarding: { primaryOwner: "Recast CS", support: ["Partner (as applicable)"], accountable: "Recast CS Leader" },
            },
          },
          rows: ["PQL", "Identification", "Qualification", "Development", "Proposal", "Closing", "ClosedWon", "Onboarding"],
          selectedStage: null,
          showStageModal: false,
          modalPosition: { top: 0, left: 0 }
        },
        msp: {
          overview: "Welcome to the Recast MSP Partner Program\n\nThe Recast MSP Program is built for service providers that want to embed Recast’s solutions into their service offerings to drive recurring revenue, expand client value, and scale with predictable economics.\n\nWe support multiple MSP archetypes—from infra-focused to app-centric—with enablement tailored to each type. Whether you’re a high-touch implementation shop or a lightweight automation-led MSP, this program offers flexible models to fit your business.\n\nProgram Highlights:\n\n* Monthly point-based licensing structure for easy cost forecasting\n\n* Tiered margin tiers based on deal ownership and engagement\n\n* Access to white-labeled deployment kits, SOWs, and enablement tools\n\n* Support for both application workspace and endpoint solutions\n\n* Designed to protect partner margin, loyalty, and renewal rights",
          requirements: [
            "Invitation and approval from Recast Channel Leadership",
            "Executed Master Partner or OEM Agreement",
            "Active go-to-market motion and enablement plan on file",
            "Quarterly alignment on co-sell activity or pipeline reviews (QBRs)",
            "Minimum monthly point commitment (entry tier: 300 points/month)",
            "Completion of required certifications for eligible product lines",
            "Agreement to Rules of Engagement and margin structure"
          ],
          benefits: [
            "Registered deal margin (per Tier definition)",
            "Renewal margin protection with activity compliance",
            "Monthly point-based pricing tiers with discounted rates at scale",
            "Recast partner portal access",
            "Prebuilt “Campaigns-in-a-Box” and brand kits",
            "Partner services packaging playbooks (SOWs, pricing templates)",
            "Self-service training and deployment kits",
            "Joint lead-gen campaigns and MDF eligibility (tier-based)",
            "Dedicated partner support lines for sales, SE, and services",
            "Recast Account Manager for joint planning",
            "Eligibility for Recast-sourced leads (with active plan and certs)"
          ],
          onboarding: {
            steps: [
              "Partner invitation and agreement execution",
              "Assign internal Partner Sales Lead and Technical Lead",
              "Complete initial certification (sales + technical track)",
              "Define GTM and enablement plan with Recast Channel Manager",
              "Select monthly point commitment tier",
              "Gain access to:\n * Partner Portal\n * Deployment and packaging toolkits\n * Sales motion playbooks\n * Points-based pricing calculator",
              "Launch your first co-sell or registered opportunity",
              "Schedule first Quarterly Business Review (QBR)"
            ],
            resources: [
              "New Partner Starter Kit",
              "Certification path guides",
              "Pricing and packaging calculator",
              "Application Workspace and Right Click Tool playbooks",
              "Partner FAQ and escalation contact list"
            ]
          },
          roe: [
            "Deal Registration is Mandatory\nAll partner-led opportunities must be registered and approved in the Partner Portal to qualify for margin and Partner of Record (PoR) status.",
            "Partner of Record (PoR) Protection\nApproved PoR partners retain rights for the full customer lifecycle, including renewals and expansions, provided they maintain active engagement (e.g., QBRs, renewal activity).",
            "Discount Policy\nRecast will not discount or quote any PoR-owned customer below partner pricing unless pre-approved through a formal channel escalation.",
            "Conflict Resolution\nIn overlapping claims, Recast Channel Leadership will evaluate based on:\n* Deal registration timestamp\n* CRM activity log\n* Customer attestation (if needed)",
            "Renewal Ownership\nPartner of Record retains renewal margin unless:\n* Customer explicitly reassigns to another partner\n* Partner has been inactive and missed renewal planning window",
            "Sales Collaboration\nRequirements vary by Tier:\n* Tier 1: partner-driven\n* Tier 2: co-sell required\n* Tier 3: Recast-owned",
            "Ethical Conduct\nAll partners must comply with Recast’s Code of Conduct, anti-poaching rules, and maintain professional behavior in joint accounts.",
            "Margin Tier Enforcement\n* Tiers 1–3 define margin eligibility\n* Margins reset if Tier criteria are not met\n* Quarterly review of Tier performance and partner tiering",
            "Governance\n* Lead registration valid for 30 days; can be renewed with pipeline activity\n* Tier reviews occur quarterly\n* Escalation SLA: 5 business days to VP of Partner Programs"
          ]
        },
        model: {
          tiers: {
            Registered: {
              overview: "Registered partners are either License Added Resellers (LARs) or referral partners who help Recast reach more customers.\n\n* LARs handle the transaction — they place the order and act as the bill-to on behalf of the customer. They earn up to a 5% margin on those deals.\n\n* Referral partners introduce Recast to a customer or opportunity. If we close the deal directly, they can receive up to a 5% rebate at Recast’s discretion.\n\nThese partnerships are lightweight and transactional — no formal agreement is required. We simply set up the partner in Salesforce with valid billing information and process orders as needed.\nThey’re a low-overhead way for Recast to fulfill deals or expand into new opportunities through trusted local or resale partners.",
              requirements: [
                "Salesforce Bill‑To Account",
              ],
              benefits: [
                "Resell Licensing",
                "Listing on Recastsoftware.com",
              ],
            },
            'Value/Preferred': {
              overview: "Value/Preferred Partners are approved resellers or referral partners who actively collaborate with Recast on qualified opportunities and co-selling motions. They are beyond transactional resale — investing time and resources to build Recast expertise, pursue certifications, and establish repeatable sales and delivery motions.\n\nThese partners typically co-sell and co-market with Recast, leveraging our technical experts and marketing resources to expand reach, accelerate deal velocity, and build early customer success stories. They are focused on the right customer segments, maintain a defined sales presence, and often represent Recast within their regional or vertical markets.\n\nValue/Preferred Partners demonstrate early-stage commitment through pipeline creation, deal registration, and customer enablement. They receive access to enablement, marketing funds, and field collaboration to help them grow toward Strategic/Premier-level engagement.\n\nValue/Preferred Partners are in the growth phase of the Recast ecosystem — proving alignment, building capability, and showing consistent commitment to joint success.",
              requirements: [
                "Partner Agreement Signed",
                "Partner Profile Submission",
                "Technical Certification: 1 Individual",
                "Sales Certification: 1 Individual",
                "Minimum Annual Deal Volume: 4 Deals per Year"
              ],
              benefits: [
                "Resell Licensing",
                "Access to Partner Portal",
                "Listing on Recastsoftware.com",
                "Self-Service Training",
                "Campaigns-in-a-Box",
                "Partner NFR Licensing",
                "Partner of Record (PoR) Eligibility",
                "Eligible for MSP or Resell Delivery Model",
              ],
            },
            'Strategic/Premier': {
              overview: "Strategic/Premier Partners are strategic, invite-only collaborators who represent Recast at the highest level of partnership. These partners have demonstrated sustained revenue growth, deep technical and sales capability, and a long-term commitment to joint business planning with Recast leadership.\n\nThey are fully enabled to co-sell, co-market, and co-deliver Recast solutions, often representing our brand in major enterprise environments. Strategic/Premier Partners maintain certified technical resources, dedicated sales and marketing teams, and a defined customer base that aligns with Recast’s target markets and geographies.\n\nEach Strategic/Premier Partner has a joint business plan with Recast — including shared revenue targets, annual growth goals, and investment commitments across enablement, customer adoption, and marketing execution. They also participate in roadmap reviews, quarterly business planning, and go-to-market alignment with Recast executives.\n\nStrategic/Premier Partners are our most strategic alliances — delivering measurable impact through scale, shared investment, and sustained customer success across regions and verticals.",
              requirements: [
                "Partner Agreement Signed",
                "Partner Profile Submission",
                "Technical Certification: 2 Individuals",
                "Sales Certification: 2 Individuals",
                "Quarterly Business Review (QBR)",
                "Mutual Business Plan | Min. Deal volume plan in place",
              ],
              benefits: [
                "Resell Licensing",
                "Access to Partner Portal",
                "Listing on Recastsoftware.com",
                "Self-Service Training",
                "Campaigns-in-a-Box",
                "Exclusive Roadmap Preview/Access for requests",
                "Partner NFR Licensing",
                "CPQ Self Service (quote-to-order)",
                "Partner of Record (PoR) Eligibility",
                "Eligible for MSP or Resell Delivery Model",
                "Dedicated Support Contact",
                "Recast Marketing | Demand Gen Support ",
                "Lead Pass | Services Delivery Leads",
                "Recast Executive Support",
                "Co-Sell & Expansion Support",
              ],
            },
          },
          margins: {
            Annual: {
              "Net New": {
                "Value/Preferred|Strategic/Premier": [
                  { band: "Tier 1", upTo: "25%", when: "Partner sourced AND registered AND leads qualification → close AND owns demo OR technical validation AND certs active" },
                  { band: "Tier 2", upTo: "15%", when: "Co-sell motion AND Recast supports demo/SE work AND Partner participates but does not run full cycle" },
                  { band: "Tier 3", upTo: "5% (discretionary)", when: "Referral OR LAR transaction AND Recast fully owns sale" },
                ],
                Registered: [
                  { band: "Tier 3", upTo: "5% (discretionary)", when: "Get up to 5% margin for transacting or rebated for demand gen" },
                ],
              },
              Renewal: {
                "Value/Preferred|Strategic/Premier": [
                  { band: "Tier 1", upTo: "5%", when: "Preferred/Premier w/ PoR-L" },
                  { band: "Tier 2", upTo: "5%", when: "Non-incumbent" },
                  { band: "Tier 3", upTo: "0–5% (discretionary)", when: "Registered" },
                ],
                Registered: [{ band: "Tier 3", upTo: "0–5% (discretionary)", when: "Registered" }],
              },
            },
            Monthly: {
              "Net New": {
                "Value/Preferred|Strategic/Premier": [
                  { band: "Tier 1", upTo: "25%", when: "Partner sourced AND registered AND leads qualification → close AND owns demo OR technical validation AND certs active" },
                  { band: "Tier 2", upTo: "15%", when: "Co-sell motion AND Recast supports demo/SE work AND Partner participates but does not run full cycle" },
                  { band: "Tier 3", upTo: "5% (discretionary)", when: "Referral OR LAR transaction AND Recast fully owns sale" },
                ],
                Registered: [
                  { band: "Tier 3", upTo: "5% (discretionary)", when: "Partner originated AND Partner registered AND Recast approved" },
                ],
              },
              Renewal: {
                "Value/Preferred|Strategic/Premier": [
                  { band: "Tier 1", upTo: "5%", when: "Preferred/Premier w/ PoR-L" },
                  { band: "Tier 2", upTo: "5%", when: "Non-incumbent" },
                  { band: "Tier 3", upTo: "0–5% (discretionary)", when: "Registered" },
                ],
                Registered: [{ band: "Tier 3", upTo: "0–5% (discretionary)", when: "Registered" }],
              },
            },
          },
          onboarding: {
            steps: [
              { name: "Onboard", items: [
                "Activate agreements & meeting cadence",
                "Install partner licenses; demo-back",
                "Technical accreditation (≥1)",
                "Sales accreditation (≥1)",
              ]},
              { name: "Activate", items: [
                "Register leads in Partner Central",
                "Use marketing resources",
                "Develop opportunities with tools & demos",
                "First deal achieved",
                "Directory listing & website promotion",
              ]},
              { name: "Accelerate", items: [
                "Marketing plan & events/webinars",
                "Create repeatable offer",
                "≥6 licensing deals annually",
                "Nominate for partner awards",
                "Drive expansions & renewals",
              ]},
            ],
          },
          roe: {
            principles: [
              { principle: "Deal Registration", description: "Mandatory for all partners. All deals must be registered to qualify for margin and PoR. Registration expires after 30 days unless renewed with activity.", intent: "Protect partner investment and ensure visibility." },
              { principle: "Partner of Record (PoR)", description: "Two types: PoR-T (Transactional, for Registered tier, expires at renewal) and PoR-L (Lifecycle, for Preferred/Premier/MSP, valid for renewals/expansions if active). PoR-L expires if no renewal activity at 180, 120, or 90 days prior.", intent: "Encourage long-term engagement and protect incumbents." },
              { principle: "Sales Motion", description: "Tier 1 (Full-Cycle: Partner leads, 25% margin), Tier 2 (Co-Sell: Joint, 15% margin, comp-neutral), Tier 3 (Transactional/Referral: Recast leads, 5% discretionary). Eligibility based on certifications and participation.", intent: "Align compensation with effort and neutrality." },
              { principle: "Renewal Ownership", description: "PoR-L retains renewals with outreach at 180/120/90 days. Miss all → PoR expires 60 days prior, reassigned to Recast.", intent: "Reward active partners and ensure renewals." },
              { principle: "Conflict Resolution", description: "Evaluated by timestamp, activity, and customer input. Escalation to VP within 5 days.", intent: "Fairness and quick resolution." },
              { principle: "Ethical Conduct", description: "Adhere to code of conduct and anti-poaching rules.", intent: "Maintain trust and integrity." }
            ],
            bands: [
              { band: "Tier 1 – Full Cycle", criteria: ["Partner sourced/registered", "Partner runs demo/validation", "Certs active", "Preferred/Premier/MSP only"], eligible: "Preferred/Premier/MSP", margin: "25%", example: "Partner leads entire sale with minimal Recast support." },
              { band: "Tier 2 – Co-Sell", criteria: ["Joint participation", "Recast supports demo/SE", "MAP uploaded", "Preferred/Premier/MSP only"], eligible: "Preferred/Premier/MSP", margin: "15%", example: "Shared effort; Recast aids in qualification/demo." },
              { band: "Tier 3 – Transactional/Referral", criteria: ["Partner intro only", "Recast runs sale", "All tiers eligible"], eligible: "All", margin: "5% (discretionary)", example: "Referral or LAR transaction." }
            ],
            governance: [
              { element: "Registration Validity", definition: "30 days; auto-expire nightly if expired." },
              { element: "PoR Expiry", definition: "Nightly job expires PoR-L if outreach missed." },
              { element: "Certification Alerts", definition: "Alerts 30 days prior to expiry." },
              { element: "Scorecard Refresh", definition: "Nightly refresh of partner scorecards." },
              { element: "Escalation SLA", definition: "5 business days to VP of Partner Programs." }
            ],
            summary: [
              { tier: "Strategic/Premier", engagement: "Full-cycle (Tier 1)", involvement: "Light-touch", range: "25%", notes: "Top-tier, full control of sales motion" },
              { tier: "Value/Preferred", engagement: "Joint sale (Tier 2)", involvement: "Moderate", range: "15%", notes: "Co-sell and presales collaboration" },
              { tier: "Registered / LAR", engagement: "Transactional (Tier 3)", involvement: "Recast-led", range: "5% (discretionary)", notes: "Finder’s fee or referral incentive only." },
            ],
            conflicts: "In cases of overlapping claims, Recast Channel Leadership will evaluate based on deal registration timestamp, documented activity, and customer attestation.",
            escalation: "Channel disputes escalated to VP of Partner Programs within 5 business days."
          },
          other: {
            overview: "",
            partnerTypesDescs: [
              "Managed Service Providers (MSPs) are strategic delivery partners who package Recast’s technology into their own managed services — helping customers manage, secure, and optimize their IT environments more efficiently.\n\nMSPs think in monthly recurring revenue (MRR) — not annual contracts. They operate on predictable, consumption-based models and need software that scales with them, not against them. Recast fits perfectly into this model by being easy to deploy, multitenant, and designed for repeatable use across clients.\n\nRather than making margin on licenses, MSPs make money on the services they deliver around the software — configuration, automation, monitoring, and continuous management. Recast helps them improve their margins by reducing manual effort, increasing client coverage, and adding high-value capabilities they can bundle into existing service offerings.\n\nFor many MSPs, Recast also opens the door to application management as a service, expanding beyond traditional infrastructure or security management into new, higher-value revenue streams.\n\nMSP partners are a key part of Recast’s ecosystem — they scale our reach, drive recurring adoption, and deliver measurable customer outcomes every month.",
              "ISV partners are technology companies that package and resell Recast as part of their broader solution, creating a stronger combined offering for customers. These partners typically embed or align Recast’s capabilities with their own platform to enhance value, accelerate sales cycles, and simplify deployment for joint customers.\n\nBy partnering with Recast, ISVs can address more customer pain points, eliminate common objections around integration or workflow gaps, and bring a ready-to-deploy joint solution to market faster.\n\nISV partners typically co-sell and co-market with Recast — leveraging joint messaging, enablement, and go-to-market programs to expand reach, build credibility, and drive new revenue.\n\nTogether, we deliver a unified, higher-value solution that helps both companies win faster, sell more efficiently, and serve customers better.",
              "OEM partners are strategic technology companies that embed Recast’s capabilities directly into their own products or platforms to enhance functionality, performance, or customer experience. These relationships extend Recast’s reach to thousands of customers through the partner’s existing technology ecosystem.\n\nIn an OEM model, the partner licenses and integrates Recast technology under their own brand, delivering it as a seamless part of their broader solution. This creates a tightly coupled, scalable go-to-market motion where Recast’s value is distributed through a trusted, established platform — accelerating adoption and expanding market penetration.\n\nOEM partnerships are highly strategic and collaborative, often involving joint engineering, product road mapping, and go-to-market alignment at both the technical and executive level.\n\nTogether, OEM partners and Recast bring enterprise-grade solutions to market faster, reduce deployment complexity for customers, and create durable, high-value revenue streams for both organizations.",
              "Distributors are territory-based partners with exclusive rights to represent and grow Recast within a defined region or market. They act as our local extension — managing partner recruitment, enablement, and demand generation to expand Recast’s reach and market share.\n\nThese partners typically maintain a network of resellers, MSPs, and system integrators in their region. They handle localized sales, billing, and first-line support, ensuring smooth customer engagement while helping Recast maintain brand and commercial consistency across markets.\n\nDistributors are responsible for developing regional pipeline, building and enabling sub-partners, and executing go-to-market plans aligned with Recast’s global objectives. They also collaborate with Recast on marketing, events, and regional channel strategy to ensure sustained partner and customer growth.\n\nThis model allows Recast to enter new markets efficiently, ensure local expertise, and scale faster through a trusted regional partner that’s fully invested in our success."
            ],
            requirements: [
              "Invitation from Recast Channel Leadership",
              "Signed Master or OEM Agreement",
              "Defined go-to-market motion and enablement plan",
              "Quarterly alignment on co-sell and marketing activities"
            ],
            partners: [
              { partnerType: "Technology Partner (ISV)", tierEligibility: "Strategic/Premier", margin: "Negotiated; typically Tier 2 equivalent + referral incentives", dealRegistration: "Optional", mdfAccess: "Co-marketing only", enablement: "Developer enablement, API/SDK certification" },
              { partnerType: "OEM Partner", tierEligibility: "Strategic/Premier", margin: "Embedded / co-sell pricing (not margin-based)", dealRegistration: "N/A", mdfAccess: "Strategic MDF", enablement: "OEM SDK, roadmap collaboration, joint solution blueprints" },
              { partnerType: "Distributor Partner", tierEligibility: "Strategic/Premier", margin: "Transactional (Tier 3 equivalent, pre-negotiated)", dealRegistration: "Required", mdfAccess: "Tiered MDF by volume", enablement: "Distributor onboarding toolkit, partner training delivery" },
            ]
          }
        },
        partnerEvents: {
          summaries: [
            { type: "Webinars", icon: "video", description: "Interactive online sessions showcasing joint solutions, best practices, and customer stories.", avgInvited: 926, avgAttended: 853, avgOpps: 222, avgOppInvited: "24%", avgOppAttended: "26%", avgClosed: 59, win: "27%", benefit: "High engagement with targeted audiences, leading to qualified leads and accelerated pipeline." },
            { type: "User Groups", icon: "users", description: "Community-focused meetings for end-users to share experiences and learn from experts.", avgInvited: 21, avgAttended: 17, avgOpps: 4, avgOppInvited: "21%", avgOppAttended: "25%", avgClosed: 1, win: "24%", benefit: "Builds loyalty and uncovers expansion opportunities through direct customer interactions." },
            { type: "Events (incl. Conf + HH)", icon: "calendar", description: "In-person conferences and happy hours for networking and product demonstrations.", avgInvited: 330, avgAttended: 300, avgOpps: 85, avgOppInvited: "25%", avgOppAttended: "28%", avgClosed: 25, win: "28%", benefit: "Face-to-face connections that foster trust and drive higher conversion rates." },
            { type: "Partner Events", icon: "handshake", description: "Collaborative gatherings with partners to align strategies and generate joint opportunities.", avgInvited: 280, avgAttended: 207, avgOpps: 52, avgOppInvited: "19%", avgOppAttended: "25%", avgClosed: 12, win: "24%", benefit: "Strengthens partnerships and creates shared pipelines for mutual growth." },
          ]
        },
        filterModalOpen: false,
        selectedPartnerTypes: [],
        dealRegNotes: {
          partner: `FOR PARTNERS — HOW WE WORK WITH YOU\n1. Register your deals — that protects your position.\nSubmit via the Partner Portal or CSV.\nAs soon as you register a lead:\n\n* We check Salesforce to confirm it’s not already being worked\n\n* Your Partner Manager reviews it\n\n* We assign you visibility on the account and any related opportunity\n\n2. We will NEVER work a registered deal behind your back.\nIf you register a deal, we treat you as the lead stakeholder by default.\n3. You choose how involved you want us to be.\nOnce approved, you decide:\n\n* Partner-Led: You run the deal end-to-end\n\n* Co-Sell: You and our AE work together (you run discovery, we run commercial close)\n\n* Sales-Led Referral: You just make the intro and we run the full cycle\n\n4. You keep credit and visibility.\nYou always see:\n\n* Opportunity progress\n\n* Stages\n\n* Activities\n\n* Forecast signals`,
          internal: `FOR SALES — WHAT YOU NEED TO KNOW\n1. Partner deals WILL NOT create duplicate work for you.\nSalesforce automatically flags whether you’re already working the account.\nIf you are → Partner gets notified, you keep ownership, and there’s no conflict.\n2. When a new partner lead comes in, one of three things happens:\nA. Partner-Led\n\n* Partner works the full cycle\n\n* You get visibility\n\n* You still get full quota credit\n\nB. Co-Sell\n\n* You handle pricing + licensing\n\n* Partner handles discovery + services\n\n* Shared deal, shared visibility\n\nC. Sales-Led Referral\n\n* Partner introduces → you run the deal\n\n* Partner gets referral compensation\n\n3. You always get full quota credit.\nQuota credit is rep-neutral:\nIf the account is in your territory, you get 100% credit regardless of who works the deal.\n4. No conflict, no surprises.\nPartner Managers handle deal registration, routing, and conflict resolution.\nYou will never get blindsided by a partner-registered deal being worked behind the scenes.`,
          summary: `THE SIMPLE SUMMARY\nPartners: Register your deals. You get visibility, protection, and control.\nWe won’t work deals behind your back. You choose Partner-Led, Co-Sell, or Referral.\nSales: Partners will bring deals. You’ll either co-sell with them or they’ll run the deal.\nYou always keep full quota credit. No duplicates. No surprises.`
        }
      };
      const PARTNER_TYPES = ["Program Overview", "Registered", "Value/Preferred", "Strategic/Premier", "Technology Partner (ISV)", "OEM Partner", "Distributor Partner"]; // Removed MSP from dropdown
      const TABS = [
        { id: 'overview', label: 'Overview', icon: 'book-open' },
        { id: 'requirements', label: 'Requirements & Benefits', icon: 'check-circle' },
        { id: 'onboarding', label: 'Onboarding', icon: 'rocket' },
        { id: 'salesmotion', label: 'Sales Motion', icon: 'table' },
        { id: 'margins', label: 'Margins', icon: 'dollar-sign' },
        { id: 'roe', label: 'Rules of Engagement', icon: 'gavel' }
      ];
      function initFilter() {
        STATE.selectedPartnerTypes = PARTNER_TYPES.slice();
        if (typeof localStorage !== 'undefined') {
          try {
            const saved = localStorage.getItem('recastPartnerTypeFilter');
            if (saved) {
              const parsed = JSON.parse(saved);
              STATE.selectedPartnerTypes = parsed.selectedPartnerTypes.filter(t => PARTNER_TYPES.includes(t));
            }
          } catch (e) {
            // fallback to default
          }
        }
        if (STATE.selectedPartnerTypes.length === 0) {
          STATE.selectedPartnerTypes = PARTNER_TYPES.slice();
        }
        if (!STATE.selectedPartnerTypes.includes(STATE.partnerType)) {
          STATE.partnerType = STATE.selectedPartnerTypes[0] || PARTNER_TYPES[0];
        }
      }
      function setDefaultTier(type) {
        if (type === 'Registered') return 'tier3';
        if (type === 'Value/Preferred') return 'tier2';
        return 'tier1';
      }
      function getPartnerData(type) {
        if (type === "Program Overview") {
          return {
            overview: '',
            requirements: [],
            benefits: [],
            isStandard: false,
            isPremier: false,
            isPreferred: false,
            specific: null
          };
        }
        if (["Registered", "Value/Preferred", "Strategic/Premier"].includes(type)) {
          return {
            overview: STATE.model.tiers[type].overview,
            requirements: STATE.model.tiers[type].requirements,
            benefits: STATE.model.tiers[type].benefits,
            isStandard: true,
            isPremier: type === "Strategic/Premier",
            isPreferred: type === "Value/Preferred",
            specific: null
          };
        } else {
          const descIndex = ['Technology Partner (ISV)', 'OEM Partner', 'Distributor Partner'].indexOf(type) + 1; // Adjusted index since MSP is 0 but removed
          const desc = STATE.model.other.partnerTypesDescs[descIndex];
          return {
            overview: desc,
            requirements: STATE.model.other.requirements,
            benefits: STATE.model.tiers['Strategic/Premier'].benefits,
            isStandard: false,
            isPremier: false,
            isPreferred: false,
            specific: STATE.model.other.partners.find(p => p.partnerType === type)
          };
        }
      }
      function render() {
        if (!STATE.selectedPartnerTypes.includes(STATE.partnerType)) {
          STATE.partnerType = STATE.selectedPartnerTypes[0] || PARTNER_TYPES[0];
        }
        const data = getPartnerData(STATE.partnerType);
        let html = '<div class="space-y-6">';
        html += renderPartnerTypeSelector();
        html += renderTabs();
        html += '<div class="rounded-2xl bg-white p-6 shadow-md hover:shadow-lg transition-shadow duration-300">';
        switch (STATE.activeTab) {
          case 'overview':
            html += renderOverview(STATE.showMspOption && (STATE.partnerType === 'Value/Preferred' || STATE.partnerType === 'Strategic/Premier') ? STATE.msp.overview : data.overview, data.isPreferred || data.isPremier);
            break;
          case 'requirements':
            html += renderRequirementsAndBenefits(STATE.showMspOption && (STATE.partnerType === 'Value/Preferred' || STATE.partnerType === 'Strategic/Premier') ? STATE.msp.requirements : data.requirements, STATE.showMspOption && (STATE.partnerType === 'Value/Preferred' || STATE.partnerType === 'Strategic/Premier') ? STATE.msp.benefits : data.benefits, data.isPremier);
            break;
          case 'margins':
            if (data.isStandard) {
              html += renderMarginsContent();
            } else {
              html += renderDetailsContent(data.specific);
            }
            break;
          case 'roe':
            html += renderROEContent();
            break;
          case 'salesmotion':
            html += renderSalesMotionContent();
            break;
          case 'onboarding':
            if (STATE.partnerType !== 'Registered') {
              html += renderOnboardingContent(STATE.showMspOption && (STATE.partnerType === 'Value/Preferred' || STATE.partnerType === 'Strategic/Premier') ? { ...data, overview: STATE.msp.overview, requirements: STATE.msp.requirements, benefits: STATE.msp.benefits, onboarding: STATE.msp.onboarding } : data);
            } else {
              html += '<p class="text-center text-gray-700 leading-relaxed">Not applicable for Registered partners.</p>';
            }
            break;
        }
        html += '</div>';
        html += '</div>';
        html += renderFilterTrigger();
        if (STATE.filterModalOpen) html += renderFilterModal();
        if (STATE.showBusinessPlanModal) {
          html += renderBusinessPlanModal();
        }
        if (STATE.showEvaluationModal) {
          html += renderEvaluationModal();
        }
        if (STATE.showPartnerEventsModal) {
          html += renderPartnerEventsModal();
        }
        if (STATE.showCsvModal) {
          html += renderCsvModal();
        }
        if (STATE.showLeadsGuideModal) {
          html += renderLeadsGuideModal();
        }
        if (STATE.salesCycle.showStageModal) {
          html += renderStageModal();
        }
        if (STATE.showPartnersHelpModal) {
          html += renderPartnersHelpModal();
        }
        if (STATE.showInternalROEPopout) {
          html += renderInternalROEPopout();
        }
        if (STATE.showPartnerCommPopout) {
          html += renderPartnerCommPopout();
        }
        if (STATE.showDealRegModal) {
          html += renderDealRegModal();
        }
        document.getElementById('app').innerHTML = html;
        lucide.createIcons();
        addEventListeners();
      }
      function renderFilterTrigger() {
        return `
          <div class="fixed bottom-4 left-4 z-50">
            <input type="checkbox" id="filterTrigger" class="h-4 w-4 rounded accent-[#2563eb] opacity-50 focus:opacity-100" ${STATE.filterModalOpen ? 'checked' : ''} />
          </div>
        `;
      }
      function renderFilterModal() {
        let checkboxes = '';
        PARTNER_TYPES.forEach(t => {
          const display = t === 'Registered' ? 'Registered (LAR/Referral)' : t;
          const checked = STATE.selectedPartnerTypes.includes(t) ? 'checked' : '';
          checkboxes += `
            <label class="flex items-center gap-2">
              <input type="checkbox" class="partner-type-checkbox h-4 w-4 rounded accent-[#2563eb]" data-type="${t}" ${checked} />
              ${display}
            </label>
          `;
        });
        const allChecked = STATE.selectedPartnerTypes.length === PARTNER_TYPES.length ? 'checked' : '';
        return `
          <div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 px-4" role="dialog" aria-modal="true" id="filterModalBg">
            <div class="relative max-w-md w-full bg-white rounded-xl shadow-2xl p-6">
              <button class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 focus:outline-none" id="closeFilterModal">
                <i data-lucide="x" class="h-5 w-5"></i>
              </button>
              <h2 class="text-xl font-medium mb-4">Select Partner Types to Show</h2>
              <div class="space-y-3">
                <label class="flex items-center gap-2 font-medium">
                  <input type="checkbox" id="selectAll" class="h-4 w-4 rounded accent-[#2563eb]" ${allChecked} />
                  Select All
                </label>
                ${checkboxes}
              </div>
              <div class="mt-6 flex justify-end gap-3">
                <button id="resetFilter" class="rounded-full border border-[#E2E8F0] px-4 py-2 text-sm hover:bg-gray-50 transition-colors duration-300">Reset</button>
                <button id="saveFilter" class="rounded-full bg-[#2563eb] text-white px-4 py-2 text-sm hover:bg-[#1d4ed8] transition-colors duration-300">Save</button>
              </div>
            </div>
          </div>
        `;
      }
      function renderPartnerTypeSelector() {
        let options = '';
        STATE.selectedPartnerTypes.forEach(type => {
          options += `<option value="${type}" ${STATE.partnerType === type ? 'selected' : ''}>${type === 'Registered' ? 'Registered (LAR/Referral)' : type}</option>`;
        });
        return `
          <div class="flex items-center gap-4">
            <label for="partnerType" class="sr-only">Partner Type</label>
            <select id="partnerType" class="rounded-full border border-[#E2E8F0] bg-white px-4 py-2 text-sm font-medium text-gray-700 focus:outline-none focus:ring-2 focus:ring-[#2563eb] focus:ring-offset-2 transition-all duration-300">
              ${options}
            </select>
          </div>
        `;
      }
      function renderTabs() {
        let tabsHtml = '<div class="flex flex-wrap gap-2 mb-6 overflow-x-auto -mx-6 px-6 md:mx-0 md:px-0 scrollbar-hide">';
        let tabsToShow = TABS;
        if (STATE.partnerType === 'Program Overview') {
          tabsToShow = [TABS[0]]; // Only Overview
        }
        tabsToShow.forEach(tab => {
          const active = STATE.activeTab === tab.id;
          const disabled = (tab.id === 'margins' && !getPartnerData(STATE.partnerType).isStandard) || (tab.id === 'onboarding' && STATE.partnerType === 'Registered');
          tabsHtml += `
            <button
              data-tab="${tab.id}"
              class="${active ? 'bg-[#2563eb] text-white' : 'bg-white text-gray-700 hover:bg-gray-100'} ${disabled ? 'opacity-50 cursor-not-allowed' : ''} inline-flex items-center gap-2 rounded-full px-5 py-2.5 text-sm font-medium transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-[#2563eb] focus:ring-offset-2"
              ${disabled ? 'disabled' : ''}
            >
              <i data-lucide="${tab.icon}" class="h-4 w-4"></i>
              ${tab.label}
            </button>
          `;
        });
        tabsHtml += '</div>';
        return tabsHtml;
      }
      function renderOverview(overview, showButtons) {
        let html = '<h2 class="text-xl font-medium mb-6 flex items-center gap-3"><i data-lucide="book-open" class="h-6 w-6 stroke-[#2563eb]"></i>Overview</h2>';
        if (STATE.partnerType === 'Program Overview') {
          html += '<div class="mt-6 flex flex-col sm:flex-row gap-4">';
          html += '<button id="partnersHelpButton" class="rounded-full border border-[#E2E8F0] px-6 py-3 text-sm font-medium text-gray-700 hover:bg-gray-50 transition-all duration-300 flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-[#2563eb] focus:ring-offset-2"><i data-lucide="users" class="h-4 w-4"></i>Why Partner with us?</button>';
          html += '</div>';
          html += renderProgramOverviewMatrix();
        } else {
          html += `<p class="text-gray-700 leading-relaxed whitespace-pre-line transition-opacity duration-300">${overview}</p>`;
        }
        if (showButtons && (STATE.partnerType === 'Value/Preferred' || STATE.partnerType === 'Strategic/Premier')) {
          html += '<div class="mt-6 flex flex-col sm:flex-row gap-4">';
          html += `<label for="mspToggle" class="relative inline-flex cursor-pointer items-center">
            <input type="checkbox" id="mspToggle" class="sr-only peer" ${STATE.showMspOption ? 'checked' : ''}>
            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-[#2563eb] peer-focus:ring-offset-2 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all duration-300 peer-checked:bg-[#2563eb]"></div>
            <span class="ms-3 text-sm font-medium text-gray-900">View MSP Partnership Option</span>
          </label>`;
          html += '</div>';
        }
        if (showButtons && STATE.partnerType !== 'Program Overview') {
          html += '<div class="mt-6 flex flex-col sm:flex-row gap-4">';
          html += '<button id="evaluationButton" class="rounded-full border border-[#E2E8F0] px-6 py-3 text-sm font-medium text-gray-700 hover:bg-gray-50 transition-all duration-300 flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-[#2563eb] focus:ring-offset-2"><i data-lucide="scale" class="h-4 w-4"></i>Value/Preferred to Strategic/Premier Evaluation</button>';
          html += '</div>';
        }
        return html;
      }
      function renderProgramOverviewMatrix() {
        let html = '<div class="overflow-x-auto">';
        html += '<table class="min-w-full divide-y divide-[#E2E8F0]">';
        html += '<thead><tr><th class="px-4 py-2 text-left text-xs font-semibold">Benefit</th><th class="px-4 py-2 text-left text-xs font-semibold">Registered</th><th class="px-4 py-2 text-left text-xs font-semibold">Value/Preferred</th><th class="px-4 py-2 text-left text-xs font-semibold">Strategic/Premier</th></tr></thead>';
        html += '<tbody class="divide-y divide-[#E2E8F0]">';
        html += '<tr class="bg-gray-50"><td colspan="4" class="px-4 py-2 text-xs font-medium">Core Access</td></tr>';
        html += renderBenefitRow("Resell Licensing", '✓', '✓', '✓');
        html += renderBenefitRow("Access to Partner Portal", '✗', '✓', '✓');
        html += renderBenefitRow("Listing on RecastSoftware.com", '✓', '✓', '✓');
        html += renderBenefitRow("Self-Service Training", '✗', '✓', '✓');
        html += '<tr class="bg-gray-50"><td colspan="4" class="px-4 py-2 text-xs font-medium">Marketing & GTM Support</td></tr>';
        html += renderBenefitRow("Campaigns-in-a-Box", '✗', '✓', '✓');
        html += renderBenefitRow("Quarterly Roadmap Updates", '✗', '✓', '✓');
        html += renderBenefitRow("Basic Lead-Gen Support (no funding)", '✗', '✓', '✓');
        html += renderBenefitRow("Joint Lead-Gen Campaigns (with MDF Funds)", '✗', '✗', '✓');
        html += renderBenefitRow("Mutual Business Plan & GTM Alignment", '✗', '✓', '✓');
        html += '<tr class="bg-gray-50"><td colspan="4" class="px-4 py-2 text-xs font-medium">Sales & Deal Support</td></tr>';
        html += renderBenefitRow("Partner NFR Licensing", '✗', '✓', '✓');
        html += renderBenefitRow("Enhanced CRM Access (quote-to-order)", '✗', '✗', '✓');
        html += renderBenefitRow("Partner of Record (PoR) Eligibility", '✗', '✓', '✓');
        html += renderBenefitRow("Co-Sell & Expansion Support", '✗', '✓', '✓');
        html += '<tr class="bg-gray-50"><td colspan="4" class="px-4 py-2 text-xs font-medium">Delivery Enablement</td></tr>';
        html += renderBenefitRow("Eligible for MSP or Resell Delivery Model", '✗', '✓', '✓');
        html += renderBenefitRow("Access to Services Delivery Leads", '✗', '✗', '✓');
        html += '<tr class="bg-gray-50"><td colspan="4" class="px-4 py-2 text-xs font-medium">Strategic Engagement</td></tr>';
        html += renderBenefitRow("Dedicated Support", '✗', '✗', '✓');
        html += renderBenefitRow("Dedicated Recast Partner Manager", '✗', '✗', '✓');
        html += '</tbody></table></div>';
        return html;
      }
      function renderBenefitRow(benefit, reg, pref, prem) {
        return `<tr><td class="px-4 py-2 text-xs text-gray-700 leading-relaxed">${benefit}</td><td class="px-4 py-2 text-xs text-gray-700 leading-relaxed">${reg}</td><td class="px-4 py-2 text-xs text-gray-700 leading-relaxed">${pref}</td><td class="px-4 py-2 text-xs text-gray-700 leading-relaxed">${prem}</td></tr>`;
      }
      function renderRequirementsAndBenefits(requirements, benefits, isPremier) {
        let html = '<h2 class="text-xl font-medium mb-6 flex items-center gap-3"><i data-lucide="check-circle" class="h-6 w-6 stroke-[#2563eb]"></i>Requirements & Benefits</h2>';
        html += '<div class="grid grid-cols-1 md:grid-cols-2 gap-6">';
        html += '<div class="rounded-2xl bg-gray-50 p-6">';
        html += '<h3 class="text-lg font-medium mb-4 flex items-center gap-2"><i data-lucide="list-checks" class="h-5 w-5 stroke-[#2563eb]"></i>Requirements</h3>';
        html += '<ul class="space-y-4">';
        requirements.forEach(req => {
          html += `
            <li class="flex items-start gap-3">
              <div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1">
                <i data-lucide="check" class="h-3 w-3 stroke-white"></i>
              </div>
              <span class="text-gray-700 leading-relaxed">${req}</span>
            </li>
          `;
        });
        html += '</ul>';
        html += '</div>';
        html += '<div class="rounded-2xl bg-gray-50 p-6">';
        html += '<h3 class="text-lg font-medium mb-4 flex items-center gap-2"><i data-lucide="award" class="h-5 w-5 stroke-[#2563eb]"></i>Benefits</h3>';
        html += '<ul class="space-y-4">';
        benefits.forEach(ben => {
          html += `
            <li class="flex items-start gap-3">
              <div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1">
                <i data-lucide="check" class="h-3 w-3 stroke-white"></i>
              </div>
              <span class="text-gray-700 leading-relaxed">${ben}</span>
            </li>
          `;
        });
        html += '</ul>';
        html += '</div>';
        html += '</div>';
        if (isPremier) {
          html += '<div class="mt-8 rounded-2xl border border-[#E2E8F0] p-6 bg-gray-50 flex gap-3 items-start">';
          html += '<i data-lucide="info" class="h-5 w-5 mt-0.5 stroke-[#2563eb]"></i>';
          html += '<div><div class="font-medium">Strategic/Premier Tier Note</div><p class="text-gray-700 leading-relaxed text-sm mt-1">Strategic/Premier partners receive enhanced MDF and joint planning. Schedule a QBR to discuss advancement.</p></div>';
          html += '</div>';
          html += '<div class="mt-6 flex flex-col sm:flex-row gap-4">';
          html += '<button id="businessPlanButton" class="rounded-full bg-[#2563eb] text-white px-6 py-3 text-sm font-medium hover:bg-[#1d4ed8] transition-all duration-300 flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-[#2563eb] focus:ring-offset-2"><i data-lucide="file-text" class="h-4 w-4"></i>View Sample Business Plan</button>';
          html += '<button id="partnerEventsButton" class="rounded-full border border-[#E2E8F0] px-6 py-3 text-sm font-medium text-gray-700 hover:bg-gray-50 transition-all duration-300 flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-[#2563eb] focus:ring-offset-2"><i data-lucide="calendar" class="h-4 w-4"></i>Partner Events & Campaigns</button>';
          html += '</div>';
        }
        return html;
      }
      function renderMarginsContent() {
        let html = '<h2 class="text-xl font-medium mb-6 flex items-center gap-3"><i data-lucide="dollar-sign" class="h-6 w-6 stroke-[#2563eb]"></i>Margins</h2>';
        html += '<div class="rounded-2xl bg-white p-6 shadow-md mb-6">';
        html += '<h3 class="text-lg font-medium mb-4 flex items-center gap-2"><i data-lucide="filter" class="h-5 w-5 stroke-[#2563eb]"></i>Filters</h3>';
        html += '<div class="flex flex-col sm:flex-row gap-4 rounded-full border border-[#E2E8F0] p-1 bg-white mb-4">';
        html += '<select id="commitment" class="flex-1 rounded-full px-4 py-2 text-sm text-gray-700 focus:outline-none">';
        html += `<option value="Annual" ${STATE.commitment === 'Annual' ? 'selected' : ''}>Annual</option>`;
        html += `<option value="Monthly" ${STATE.commitment === 'Monthly' ? 'selected' : ''}>Monthly</option>`;
        html += '</select>';
        html += '<select id="dealType" class="flex-1 rounded-full px-4 py-2 text-sm text-gray-700 focus:outline-none">';
        html += `<option value="Net New" ${STATE.dealType === 'Net New' ? 'selected' : ''}>Net New</option>`;
        html += `<option value="Renewal" ${STATE.dealType === 'Renewal' ? 'selected' : ''}>Renewal</option>`;
        html += '</select>';
        html += '</div></div>';
        const isRegistered = STATE.partnerType === 'Registered';
        const tierKey = isRegistered ? 'Registered' : 'Value/Preferred|Strategic/Premier';
        let margins = STATE.model.margins[STATE.commitment][STATE.dealType][tierKey];
        if (!isRegistered) {
          margins = [...margins]; // copy to avoid modifying original
        }
        html += '<div class="rounded-2xl bg-white p-6 shadow-md mb-6">';
        html += '<h3 class="text-lg font-medium mb-4 flex items-center gap-2"><i data-lucide="table" class="h-5 w-5 stroke-[#2563eb]"></i>Margin Tiers</h3>';
        html += '<div class="overflow-x-auto mb-6">';
        html += '<table class="min-w-full divide-y divide-[#E2E8F0]">';
        html += '<thead><tr><th class="px-6 py-3 text-left text-sm font-semibold">Tier</th><th class="px-6 py-3 text-left text-sm font-semibold">Up to</th><th class="px-6 py-3 text-left text-sm font-semibold">When</th></tr></thead>';
        html += '<tbody class="divide-y divide-[#E2E8F0]">';
        margins.forEach(m => {
          html += `<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">${m.band}</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">${m.upTo}</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">${m.when}</td></tr>`;
        });
        html += '</tbody></table></div></div>';
        html += '<div class="rounded-2xl bg-white p-6 shadow-md mb-6">';
        html += '<h3 class="text-lg font-medium mb-4 flex items-center gap-2"><i data-lucide="calculator" class="h-5 w-5 stroke-[#2563eb]"></i>Example Calculation</h3>';
        if (isRegistered) {
          STATE.tier = 'tier3';
        }
        const availableTiers = isRegistered ? ['tier3'] : (STATE.partnerTierMeta[STATE.partnerType].fullCycleEligible ? ['tier1', 'tier2', 'tier3'] : ['tier2', 'tier3']);
        html += '<div class="flex flex-wrap gap-4 mb-4">';
        availableTiers.forEach(tier => {
          html += `
            <label class="inline-flex items-center gap-2 cursor-pointer">
              <input type="radio" name="tier" value="${tier}" ${STATE.tier === tier ? 'checked' : ''} class="form-radio h-4 w-4 text-[#2563eb] focus:ring-[#2563eb]">
              <span class="text-sm font-medium">${STATE.salesCycle.tierMeta[tier].name.split(' – ')[0]}</span>
            </label>
          `;
        });
        html += '</div>';
        html += '<div class="mt-4">';
        html += '<label for="exampleACV" class="block text-sm font-medium mb-1">Example ACV ($)</label>';
        html += '<input type="number" id="exampleACV" value="' + STATE.exampleACV + '" min="0" step="1000" class="rounded-full border border-[#E2E8F0] bg-white px-4 py-2 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-[#2563eb] focus:ring-offset-2 transition-all duration-300 w-full max-w-xs" />';
        html += '</div>';
        const upTo = margins.find(m => m.band.toLowerCase().replace(/\s/g, '') === STATE.tier.toLowerCase().replace(/\s/g, ''))?.upTo;
        const marginPercentStr = upTo.replace(/[^0-9.]/g, '');
        const marginPercent = parseFloat(marginPercentStr) / 100 || 0;
        const acv = STATE.exampleACV;
        const margin = acv * marginPercent;
        const services = margin * STATE.servicesMultiplier;
        html += '<div class="mt-6 grid grid-cols-1 sm:grid-cols-3 gap-4">';
        html += `<div class="rounded-xl bg-gray-50 p-4"><div class="text-sm font-medium mb-1">Software Margin</div><div class="text-2xl font-semibold">$${margin.toLocaleString()}</div></div>`;
        html += `<div class="rounded-xl bg-gray-50 p-4"><div class="text-sm font-medium mb-1">Est. Services Revenue</div><div class="text-2xl font-semibold">$${services.toLocaleString()}</div></div>`;
        html += `<div class="rounded-xl bg-gray-50 p-4"><div class="text-sm font-medium mb-1">Total Partner Value</div><div class="text-2xl font-semibold">$${(margin + services).toLocaleString()}</div></div>`;
        html += '</div></div>';
        return html;
      }
      function renderDetailsContent(specific) {
        let html = '<h2 class="text-xl font-medium mb-6 flex items-center gap-3"><i data-lucide="dollar-sign" class="h-6 w-6 stroke-[#2563eb]"></i>Partner Details</h2>';
        if (specific) {
          html += '<div class="space-y-4">';
          html += `<div><span class="font-medium">Tier Eligibility:</span> ${specific.tierEligibility}</div>`;
          html += `<div><span class="font-medium">Margin:</span> ${specific.margin}</div>`;
          html += `<div><span class="font-medium">Deal Registration:</span> ${specific.dealRegistration}</div>`;
          html += `<div><span class="font-medium">MDF Access:</span> ${specific.mdfAccess}</div>`;
          html += `<div><span class="font-medium">Enablement:</span> ${specific.enablement}</div>`;
          html += '</div>';
        } else {
          html += '<p class="text-gray-700 leading-relaxed">Details not available for this partner type.</p>';
        }
        return html;
      }
      function renderAudienceToggle() {
        return `
          <div class="flex gap-2 mb-6">
            <button data-toggle="partner" class="${STATE.roeView === 'partner' ? 'bg-[#2563eb] text-white' : 'bg-gray-200 text-gray-700'} rounded-full px-6 py-2 font-medium transition-all duration-300">I’m a Partner</button>
            <button data-toggle="sales" class="${STATE.roeView === 'sales' ? 'bg-[#2563eb] text-white' : 'bg-gray-200 text-gray-700'} rounded-full px-6 py-2 font-medium transition-all duration-300">I’m Recast Sales</button>
          </div>
        `;
      }
      function renderHeroSummary(view) {
        const title = view === 'partner' ? 'FOR PARTNERS — HOW WE WORK WITH YOU' : 'FOR SALES — WHAT YOU NEED TO KNOW';
        const copy = view === 'partner' ? STATE.dealRegNotes.partner : STATE.dealRegNotes.internal;
        const summary = STATE.dealRegNotes.summary;
        return `
          <div class="rounded-2xl bg-gray-100 p-6 mb-6">
            <h3 class="text-xl font-medium mb-4">${title}</h3>
            <p class="text-gray-700 leading-relaxed whitespace-pre-line mb-6">${copy}</p>
            <h3 class="text-xl font-medium mb-4">THE SIMPLE SUMMARY</h3>
            <p class="text-gray-700 leading-relaxed whitespace-pre-line">${summary}</p>
          </div>
        `;
      }
      function renderScenarioCards() {
        const cards = [
          {
            title: 'Partner-Led (You Run It) – 25% Margin',
            description: [
              'You run the entire sales cycle',
              'Recast supports by request',
              'AE receives full quota credit',
              'Best when you own the customer relationship'
            ],
            tag: 'Tier 1 – Full-Cycle',
            icon: 'user-check'
          },
          {
            title: 'Co-Sell (We Work It Together) – 15% Margin',
            description: [
              'You lead discovery & validation',
              'Recast handles licensing, pricing, close',
              'AE receives full quota credit',
              'Best when both teams need to collaborate'
            ],
            tag: 'Tier 2 – Joint Engagement',
            icon: 'handshake'
          },
          {
            title: 'Referral (Lead Pass) – 5% Margin',
            description: [
              'You make the introduction',
              'Recast runs the full cycle',
              'AE receives full quota credit',
              'Best for low-touch or quick referrals'
            ],
            tag: 'Tier 3 – Transactional',
            icon: 'arrow-right'
          }
        ];
        let cardsHtml = '<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">';
        cards.forEach(c => {
          cardsHtml += `
            <div class="rounded-2xl bg-white shadow-md p-6 hover:shadow-lg transition-shadow duration-300">
              <div class="flex items-center gap-2 mb-4">
                <i data-lucide="${c.icon}" class="h-5 w-5 stroke-[#2563eb]"></i>
                <h3 class="text-lg font-medium">${c.title}</h3>
              </div>
              <ul class="space-y-2 mb-4">
                ${c.description.map(d => `<li class="flex items-center gap-2 text-gray-700 text-sm"><i data-lucide="chevron-right" class="h-4 w-4 stroke-gray-400"></i>${d}</li>`).join('')}
              </ul>
              <span class="inline-block rounded-full bg-gray-100 px-3 py-1 text-xs font-medium text-gray-600">${c.tag}</span>
            </div>
          `;
        });
        cardsHtml += '</div>';
        return cardsHtml;
      }
      function renderLeadFlowTimeline() {
        const steps = [
          'You register a deal',
          'We check Salesforce for duplicates',
          'If Sales is already working it → Partner Manager notifies you → Sales keeps ownership',
          'If not → Partner Manager approves and creates the opportunity',
          'You choose Partner-Led (25%), Co-Sell (15%), or Referral (5%)'
        ];
        let timelineHtml = '<div class="flex overflow-x-auto gap-4 mb-6 pb-4">';
        steps.forEach((step, i) => {
          timelineHtml += `
            <div class="flex-shrink-0 w-48 rounded-2xl bg-white shadow-md p-4">
              <div class="flex items-center gap-2 mb-2">
                <span class="flex items-center justify-center w-6 h-6 rounded-full bg-[#2563eb] text-white text-xs font-medium">${i+1}</span>
                <p class="text-sm font-medium">${step}</p>
              </div>
            </div>
          `;
          if (i < steps.length - 1) {
            timelineHtml += '<div class="flex items-center"><i data-lucide="chevron-right" class="h-5 w-5 stroke-gray-400"></i></div>';
          }
        });
        timelineHtml += '</div>';
        return timelineHtml;
      }
      function renderTierExpectations() {
        let key;
        switch (STATE.partnerType) {
          case 'Registered': key = 'Registered'; break;
          case 'Value/Preferred': key = 'Value/Preferred'; break;
          case 'Strategic/Premier': key = 'Strategic/Premier'; break;
          default: return '';
        }
        if (STATE.showMspOption && (STATE.partnerType === 'Value/Preferred' || STATE.partnerType === 'Strategic/Premier')) key = 'MSP';
        const data = STATE.simpleROE[key];
        if (!data) return '';
        let html = '<div class="mb-6">';
        html += '<h3 class="text-xl font-medium mb-4">What to Expect Based on Your Tier</h3>';
        html += `
          <div class="rounded-2xl bg-white shadow-md p-6">
            <p class="text-gray-700 leading-relaxed mb-4">${data.summary}</p>
            <h4 class="text-lg font-medium mb-2">Sourcing</h4>
            <ul class="space-y-2">
              ${data.sourcing.map(s => `<li><strong>${s.label}:</strong> ${s.value}</li>`).join('')}
            </ul>
        `;
        if (data.bands && data.bands.length > 0) {
          html += `
            <details class="mt-4">
              <summary class="cursor-pointer font-medium flex justify-between items-center">Bands (details)<i data-lucide="chevron-down" class="h-5 w-5"></i></summary>
              <ul class="mt-2 space-y-2">
                ${data.bands.map(b => `<li><strong>${b.band}:</strong> ${b.when.join(', ')} - ${b.rule}</li>`).join('')}
              </ul>
            </details>
          `;
        }
        html += '</div></div>';
        return html;
      }
      function renderAccordions() {
        const accordions = [
          {
            title: 'Full RoE Policy',
            content: STATE.model.roe.principles.map(p => `<div class="mb-4"><h4 class="font-medium mb-2">${p.principle}</h4><p class="text-sm text-gray-700 mb-1">${p.description}</p><p class="text-xs text-gray-500">Intent: ${p.intent}</p></div>`).join('')
          },
          {
            title: 'Margin Bands & Eligibility',
            content: STATE.model.roe.bands.map(b => `<div class="mb-4"><h4 class="font-medium mb-2">${b.band}</h4><p class="text-sm text-gray-700 mb-1">Criteria: ${b.criteria.join('<br>')}</p><p class="text-sm text-gray-700 mb-1">Eligible: ${b.eligible}</p><p class="text-sm text-gray-700 mb-1">Margin: ${b.margin}</p><p class="text-sm text-gray-700">Example: ${b.example}</p></div>`).join('')
          },
          {
            title: 'Governance Rules',
            content: STATE.model.roe.governance.map(g => `<div class="mb-4"><h4 class="font-medium mb-2">${g.element}</h4><p class="text-sm text-gray-700">${g.definition}</p></div>`).join('')
          },
          {
            title: 'Conflict Resolution & Escalation',
            content: `<p class="text-gray-700 leading-relaxed mb-4">${STATE.model.roe.conflicts}</p><p class="text-gray-700 leading-relaxed">${STATE.model.roe.escalation}</p>`
          },
          {
            title: 'MSP / ISV / Other Models',
            content: STATE.model.other.partnerTypesDescs.map((desc, i) => `<div class="mb-4"><h4 class="font-medium mb-2">${['MSP', 'ISV', 'OEM', 'Distributor'][i]}</h4><p class="text-sm text-gray-700 whitespace-pre-line">${desc}</p></div>`).join('')
          }
        ];
        let html = '<div class="space-y-4">';
        accordions.forEach(a => {
          html += `
            <details class="rounded-2xl bg-white shadow-md">
              <summary class="p-6 flex justify-between items-center cursor-pointer font-medium">
                ${a.title}
                <i data-lucide="chevron-down" class="h-5 w-5 stroke-gray-600"></i>
              </summary>
              <div class="px-6 pb-6 text-gray-700 leading-relaxed">${a.content}</div>
            </details>
          `;
        });
        html += '</div>';
        return html;
      }
      function renderGuaranteeBlock() {
        const guarantees = [
          'We will not work your registered deals behind your back.',
          'We always check Salesforce first to avoid duplicate effort.',
          'AEs always receive full quota credit for deals in their territory.'
        ];
        return `
          <div class="rounded-2xl bg-blue-50 p-6 mb-6">
            <h3 class="text-xl font-medium mb-4">What We Guarantee</h3>
            <ul class="space-y-2">
              ${guarantees.map(g => `<li class="flex items-center gap-2 text-gray-700"><i data-lucide="shield-check" class="h-4 w-4 stroke-[#2563eb]"></i>${g}</li>`).join('')}
            </ul>
          </div>
        `;
      }
      function renderScenarioSelector() {
        return `
          <div class="mt-6">
            <h3 class="text-xl font-medium mb-4">What are you trying to do?</h3>
            <div class="flex flex-col md:flex-row gap-4">
              <button class="rounded-full bg-white border border-[#E2E8F0] px-6 py-3 text-sm font-medium text-gray-700 hover:bg-gray-50 transition-all duration-300">I found a brand new opportunity</button>
              <button class="rounded-full bg-white border border-[#E2E8F0] px-6 py-3 text-sm font-medium text-gray-700 hover:bg-gray-50 transition-all duration-300">I just want to refer a lead</button>
              <button class="rounded-full bg-white border border-[#E2E8F0] px-6 py-3 text-sm font-medium text-gray-700 hover:bg-gray-50 transition-all duration-300">I’m managing cross-sell/upsell</button>
            </div>
          </div>
        `;
      }
      function renderROEContent() {
        let html = '<h2 class="text-xl font-medium mb-6 flex items-center gap-3"><i data-lucide="gavel" class="h-6 w-6 stroke-[#2563eb]"></i>Rules of Engagement</h2>';
        html += renderAudienceToggle();
        html += '<div class="space-y-6">';
        html += '<section class="rounded-2xl bg-white p-6 shadow-md">';
        html += '<h3 class="text-lg font-medium mb-4">Core Principles</h3>';
        html += '<ul class="space-y-4">';
        STATE.model.roe.principles.forEach(p => {
          html += `
            <li>
              <h4 class="font-medium">${p.principle}</h4>
              <p class="text-sm text-gray-700">${p.description}</p>
              <p class="text-xs text-gray-500">Intent: ${p.intent}</p>
            </li>
          `;
        });
        html += '</ul>';
        html += '</section>';
        html += '<section class="rounded-2xl bg-white p-6 shadow-md">';
        html += '<h3 class="text-lg font-medium mb-4">Margin Bands</h3>';
        html += '<div class="overflow-x-auto">';
        html += '<table class="min-w-full divide-y divide-gray-200">';
        html += '<thead><tr><th class="px-4 py-2 text-left text-sm font-medium">Band</th><th class="px-4 py-2 text-left text-sm font-medium">Criteria</th><th class="px-4 py-2 text-left text-sm font-medium">Eligible Tiers</th><th class="px-4 py-2 text-left text-sm font-medium">Margin</th></tr></thead>';
        html += '<tbody class="divide-y divide-gray-200">';
        STATE.model.roe.bands.forEach(b => {
          html += `<tr><td class="px-4 py-2 text-sm">${b.band}</td><td class="px-4 py-2 text-sm">${b.criteria.join('<br>')}</td><td class="px-4 py-2 text-sm">${b.eligible}</td><td class="px-4 py-2 text-sm">${b.margin}</td></tr>`;
        });
        html += '</tbody></table></div>';
        html += '</section>';
        html += '<section class="rounded-2xl bg-white p-6 shadow-md">';
        html += '<h3 class="text-lg font-medium mb-4">Governance</h3>';
        html += '<ul class="space-y-4">';
        STATE.model.roe.governance.forEach(g => {
          html += `<li><h4 class="font-medium">${g.element}</h4><p class="text-sm text-gray-700">${g.definition}</p></li>`;
        });
        html += '</ul>';
        html += '</section>';
        html += '<section class="rounded-2xl bg-white p-6 shadow-md">';
        html += '<h3 class="text-lg font-medium mb-4">Summary by Tier</h3>';
        html += '<div class="overflow-x-auto">';
        html += '<table class="min-w-full divide-y divide-gray-200">';
        html += '<thead><tr><th class="px-4 py-2 text-left text-sm font-medium">Tier</th><th class="px-4 py-2 text-left text-sm font-medium">Engagement</th><th class="px-4 py-2 text-left text-sm font-medium">Involvement</th><th class="px-4 py-2 text-left text-sm font-medium">Margin</th><th class="px-4 py-2 text-left text-sm font-medium">Notes</th></tr></thead>';
        html += '<tbody class="divide-y divide-gray-200">';
        STATE.model.roe.summary.forEach(s => {
          html += `<tr><td class="px-4 py-2 text-sm">${s.tier}</td><td class="px-4 py-2 text-sm">${s.engagement}</td><td class="px-4 py-2 text-sm">${s.involvement}</td><td class="px-4 py-2 text-sm">${s.range}</td><td class="px-4 py-2 text-sm">${s.notes}</td></tr>`;
        });
        html += '</tbody></table></div>';
        html += '</section>';
        html += '<button id="dealRegButton" class="rounded-full bg-[#2563eb] text-white px-6 py-3 text-sm font-medium hover:bg-[#1d4ed8] transition-all duration-300 flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-[#2563eb] focus:ring-offset-2"><i data-lucide="file-text" class="h-4 w-4"></i>Deal Registration Details</button>';
        html += '</div>';
        return html;
      }
      function renderDealRegModal() {
        return `
          <div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 px-4" role="dialog" aria-modal="true" id="dealRegModal">
            <div class="relative max-w-4xl w-full bg-white rounded-2xl shadow-2xl p-8 max-h-[90vh] overflow-y-auto">
              <button class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 focus:outline-none" id="closeDealReg">
                <i data-lucide="x" class="h-6 w-6"></i>
              </button>
              <h2 class="text-xl font-medium mb-6 flex items-center gap-3"><i data-lucide="file-text" class="h-6 w-6 stroke-[#2563eb]"></i>Deal Registration</h2>
              <div class="space-y-6 text-gray-700 leading-relaxed whitespace-pre-line">.1. Partner Portal Lead Registration Form – For Individual Deal Submissions
Used when a partner salesperson submits a single deal.
Required Fields
·         First Name
·         Last Name
·         Business Email
·         Company Name
·         Country
·         Partner Campaign Source (defaults to “Salesperson”)
·         Lead Notes / BANT (optional)
 
 
What Happens
·         Leads are added into Salesforce
·         Email opt out the lead or contact – select ‘Email Opt Out’ field as ‘true’
·         They’re linked to the correct partner account and tagged with the campaign source – Add new campaign for NA Partners
·         Leads from Premier /Strategic partners are excluded from direct outreach and routed only to the Partner team
·         The assigned Partner or Region Manager reviews each lead (The demand Gen stage can mirror the direct process. In this example if the partner is registering the lead individually it can meet the highest criteria since they are filling it out in the portal. Ie default to MQL)
·         If the lead meets minimum qualification requirements:
·         It is converted into an opportunity
·         The partner is recorded as the Partner of Record (POR)
·         Qualification criteria for POR status are documented in the opportunity
 
2. CSV Upload – For Lists From Campaigns or Events
Used when partners or internal teams upload a list of leads from events like webinars or tradeshows.
Required Columns
·         First Name
·         Last Name
·         Business Email
·         Company Name
·         Country
·         Partner Campaign Source (e.g., Webinar, Event)
·         Partner Account
·         Email Opt-out (TRUE or FALSE)
·         (Optional: Lead Notes / BANT, Lead Owner, Lead Status, Date Created)[AA1] 
 
What Happens
·         Leads are added into Salesforce
·         They’re linked to the right partner and campaign
·         Leads from Premier or Strategic partners are also excluded from direct outreach and sent only to the Partner team
·         The assigned Partner or Region Manager reviews each lead
·         If the lead meets minimum qualification requirements:
·         It is converted into an opportunity
·         The partner is recorded as the Partner of Record (POR)
 [AA1]@Chelsea Eugster
 
Add email, opt in/opt out field.
 
Marketing will scrub the list.</div>
            </div>
          </div>
        `;
      }
      function renderSalesMotionContent() {
        const isRegistered = STATE.partnerType === 'Registered';
        let html = '<h2 class="text-xl font-medium mb-6 flex items-center gap-3"><i data-lucide="table" class="h-6 w-6 stroke-[#2563eb]"></i>Sales Motion</h2>';
        html += '<div class="mb-6 rounded-2xl bg-white p-6 shadow-md">';
        html += '<h3 class="text-lg font-medium mb-4 flex items-center gap-2"><i data-lucide="workflow" class="h-5 w-5 stroke-[#2563eb]"></i>Sales Cycle Stages</h3>';
        html += '<div class="relative before:content-[\'\'] before:absolute before:top-0 before:left-0 before:w-10 before:h-full before:z-10 before:pointer-events-none before:bg-gradient-to-r before:from-white before:to-transparent after:content-[\'\'] after:absolute after:top-0 after:right-0 after:w-10 after:h-full after:z-10 after:pointer-events-none after:bg-gradient-to-l after:from-white after:to-transparent">';
        html += '<div class="flex overflow-x-auto gap-2 pb-4 [scrollbar-width:none] [-ms-overflow-style:none] [&::-webkit-scrollbar]:hidden">';
        const colors = ['bg-yellow-100', 'bg-green-100', 'bg-blue-100', 'bg-purple-100', 'bg-pink-100', 'bg-yellow-100', 'bg-green-100', 'bg-blue-100'];
        STATE.salesCycle.rows.forEach((row, index) => {
          const stage = STATE.salesCycle.stages[row];
          html += `
            <button data-stage="${row}" class="flex-shrink-0 ${colors[index]} rounded-full px-4 py-2 text-sm font-medium text-gray-800 transition-all duration-200 ease-in-out cursor-pointer hover:shadow-md focus:outline-none focus:ring-2 focus:ring-[#2563eb] focus:ring-offset-2">
              ${stage.label}
            </button>
          `;
        });
        html += '</div></div></div>';
        html += '<div class="mb-6 rounded-2xl bg-white p-6 shadow-md">';
        html += '<h3 class="text-lg font-medium mb-4 flex items-center gap-2"><i data-lucide="layers" class="h-5 w-5 stroke-[#2563eb]"></i>Tier Overviews</h3>';
        html += '<div class="grid grid-cols-1 md:grid-cols-3 gap-4">';
        if (isRegistered) {
          const meta = STATE.salesCycle.tierMeta.tier3;
          html += `<div class="rounded-2xl ${meta.color} p-4"><h4 class="font-medium mb-2">${meta.name}</h4><p class="text-sm leading-relaxed">${meta.summary}</p><p class="text-sm font-medium mt-2">Margin: ${meta.margin}</p></div>`;
        } else {
          Object.keys(STATE.salesCycle.tierMeta).forEach(tier => {
            const meta = STATE.salesCycle.tierMeta[tier];
            html += `<div class="rounded-2xl ${meta.color} p-4"><h4 class="font-medium mb-2">${meta.name}</h4><p class="text-sm leading-relaxed">${meta.summary}</p><p class="text-sm font-medium mt-2">Margin: ${meta.margin}</p></div>`;
          });
        }
        html += '</div></div>';
        html += '<div class="rounded-2xl bg-white p-6 shadow-md">';
        html += '<h3 class="text-lg font-medium mb-4 flex items-center gap-2"><i data-lucide="users-round" class="h-5 w-5 stroke-[#2563eb]"></i>Ownership by Tier</h3>';
        if (isRegistered) {
          STATE.activeTier = 'tier3';
        } else {
          html += '<div class="flex flex-col sm:flex-row gap-2 mb-4 rounded-full border border-[#E2E8F0] p-1 bg-white">';
          Object.keys(STATE.salesCycle.tierMeta).forEach(tier => {
            const active = STATE.activeTier === tier;
            html += `<button data-tier="${tier}" class="flex-1 rounded-full px-4 py-2 text-sm font-medium transition-all duration-300 ${active ? 'bg-[#2563eb] text-white' : 'text-gray-700 hover:bg-gray-100'} focus:outline-none">${STATE.salesCycle.tierMeta[tier].name.split(' – ')[0]}</button>`;
          });
          html += '</div>';
        }
        html += '<div class="space-y-4">';
        STATE.salesCycle.rows.forEach(row => {
          const own = STATE.salesCycle.tiers[STATE.activeTier][row];
          html += '<div class="rounded-2xl border border-[#E2E8F0] p-6 bg-white">';
          html += `<h4 class="font-medium text-sm mb-3">${row}</h4>`;
          html += '<div class="grid grid-cols-1 md:grid-cols-3 gap-6">';
          html += '<div class="p-4 rounded-xl bg-gray-50">';
          html += '<div class="font-medium text-xs mb-1 text-gray-600 uppercase">Primary Owner</div>';
          html += '<div class="text-sm">' + own.primaryOwner + '</div>';
          html += '</div>';
          html += '<div class="p-4 rounded-xl bg-gray-50">';
          html += '<div class="font-medium text-xs mb-1 text-gray-600 uppercase">Support</div>';
          html += '<div class="flex flex-wrap gap-2">';
          own.support.forEach(s => {
            html += '<span class="rounded-full bg-white px-3 py-1 text-xs text-gray-700 border">' + s + '</span>';
          });
          html += '</div></div>';
          html += '<div class="p-4 rounded-xl bg-gray-50">';
          html += '<div class="font-medium text-xs mb-1 text-gray-600 uppercase">Accountable</div>';
          html += '<div class="text-sm">' + own.accountable + '</div>';
          html += '</div>';
          html += '</div>';
          html += '</div>';
        });
        html += '</div></div>';
        html += '<div class="mt-6 text-xs text-gray-600 flex flex-wrap gap-4">';
        html += '<span class="flex items-center gap-1"><i data-lucide="handshake" class="h-3 w-3 stroke-[#2563eb]"></i>Tier 1 rewards full-cycle ownership</span>';
        html += '<span class="flex items-center gap-1"><i data-lucide="users-round" class="h-3 w-3 stroke-[#2563eb]"></i> Tier 2 is co-sell</span>';
        html += '<span class="flex items-center gap-1"><i data-lucide="shield-check" class="h-3 w-3 stroke-[#2563eb]"></i> Tier 3 is referral/transactional</span>';
        html += '</div>';
        html += '<div class="mt-4 rounded-2xl border border-[#E2E8F0] p-6 bg-gray-50 flex gap-3 items-start">';
        html += '<i data-lucide="info" class="h-5 w-5 mt-0.5 stroke-[#2563eb]"></i>';
        html += '<div><div class="font-medium">Lead Registration & Partner of Record</div><p class="text-gray-700 leading-relaxed text-sm mt-1">A lead is not considered Partner of Record until approved by Recast through the Partner Portal. Margin eligibility is set at deal approval based on documented ownership and CRM evidence.</p></div>';
        html += '</div>';
        return html;
      }
      function renderOnboardingContent(data) {
        let html = '<h2 class="text-xl font-medium mb-6 flex items-center gap-3"><i data-lucide="rocket" class="h-6 w-6 stroke-[#2563eb]"></i>Onboarding</h2>';
        let certHtml = '<div class="rounded-2xl bg-amber-100 border border-amber-200 p-6 mb-6">';
        certHtml += '<h3 class="text-lg font-medium mb-2 flex items-center gap-2"><i data-lucide="award" class="h-5 w-5 stroke-[#d97706]"></i>Required Certifications</h3>';
        let certText;
        if (STATE.partnerType === 'MSP' || STATE.showMspOption) {
          certText = 'Initial sales and technical certifications for eligible product lines.';
        } else if (STATE.partnerType === 'Value/Preferred') {
          certText = '1 Certified Sales resource and 1 Certified Technical resource.';
        } else if (STATE.partnerType === 'Strategic/Premier') {
          certText = 'Certified sales and technical resources (minimum 2 each recommended).';
        } else {
          certText = 'Customized onboarding based on GTM motion; must complete GTM certification.';
        }
        certHtml += `<p class="text-gray-700 leading-relaxed">For ${STATE.partnerType} partners: ${certText} These must be completed during the initial onboarding phase before advancing and accessing full partner benefits, resources, and margin eligibility.</p>`;
        certHtml += '</div>';
        html += certHtml;
        if (data.isStandard) {
          const steps = STATE.model.onboarding.steps;
          let buttonsHtml = '<div class="flex flex-wrap gap-3 mb-6">';
          steps.forEach((s, i) => {
            const active = STATE.activeStep === i;
            buttonsHtml += `
              <button
                data-step="${i}"
                class="${active ? 'bg-[#2563eb] text-white' : 'bg-white text-gray-700 hover:bg-gray-100'} inline-flex items-center gap-2 rounded-full px-5 py-2.5 text-sm font-medium transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-[#2563eb] focus:ring-offset-2"
              >
                <i data-lucide="${active ? 'check-circle' : 'circle'}" class="h-4 w-4"></i>
                ${s.name}
              </button>
            `;
          });
          buttonsHtml += '</div>';
          const items = steps[STATE.activeStep].items;
          let listHtml = '<ul class="space-y-4">';
          items.forEach((item) => {
            listHtml += `
              <li class="flex items-start gap-3">
                <div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1">
                  <i data-lucide="check" class="h-3 w-3 stroke-white"></i>
                </div>
                <span class="text-gray-700 leading-relaxed">${item}</span>
              </li>
            `;
          });
          listHtml += '</ul>';
          html += buttonsHtml + listHtml;
        } else if (STATE.partnerType === 'MSP' || STATE.showMspOption) {
          html += '<h3 class="text-xl font-medium mb-4">Onboarding Steps:</h3>';
          html += '<ol class="space-y-4 list-decimal pl-6">';
          data.onboarding.steps.forEach(s => {
            html += `<li class="text-gray-700 leading-relaxed">${s.replace(/\n/g, '<br>')}</li>`;
          });
          html += '</ol>';
          html += '<h3 class="text-xl font-medium mt-8 mb-4">Resources Provided:</h3>';
          html += '<ul class="space-y-4">';
          data.onboarding.resources.forEach(r => {
            html += `
              <li class="flex items-start gap-3">
                <div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1">
                  <i data-lucide="check" class="h-3 w-3 stroke-white"></i>
                </div>
                <span class="text-gray-700 leading-relaxed">${r}</span>
              </li>
            `;
          });
          html += '</ul>';
        } else {
          // For OEM, ISV, Distributor - already handled in certHtml
        }
        return html;
      }
      function renderBusinessPlanModal() {
        return `
          <div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 px-4" role="dialog" aria-modal="true" id="businessPlanModal">
            <div class="relative max-w-4xl w-full bg-white rounded-2xl shadow-2xl p-8 max-h-[90vh] overflow-y-auto">
              <button class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 focus:outline-none" id="closeBusinessPlan">
                <i data-lucide="x" class="h-6 w-6"></i>
                <span class="sr-only">Close</span>
              </button>
              <h2 class="text-xl font-medium mb-6 flex items-center gap-3"><i data-lucide="file-text" class="h-6 w-6 stroke-[#2563eb]"></i>Partner Business Plan</h2>
              <p class="text-center font-semibold mb-8 text-gray-700 leading-relaxed">Recast Software + CoreSecure Systems</p>
              ${renderBusinessPlanContent()}
            </div>
          </div>
        `;
      }
      function renderPartnerEventsModal() {
        return `
          <div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 px-4" role="dialog" aria-modal="true" id="partnerEventsModal">
            <div class="relative max-w-4xl w-full bg-white rounded-2xl shadow-2xl p-8 max-h-[90vh] overflow-y-auto">
              <button class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 focus:outline-none" id="closePartnerEvents">
                <i data-lucide="x" class="h-6 w-6"></i>
                <span class="sr-only">Close</span>
              </button>
              <h2 class="text-2xl font-semibold mb-4 text-center">Joint Marketing Campaigns: Driving Demand Together</h2>
              <p class="text-gray-700 leading-relaxed mb-8 text-center max-w-2xl mx-auto">At Recast, we collaborate with partners to host impactful events that attract high-quality attendees and convert them into closed-won opportunities. Our expertise in demand generation provides a significant advantage, helping you build a stronger pipeline with less effort.</p>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                ${STATE.partnerEvents.summaries.map(s => `
                  <div class="rounded-2xl bg-gray-50 p-6 shadow-md">
                    <div class="flex items-center gap-3 mb-4">
                      <i data-lucide="${s.icon}" class="h-6 w-6 stroke-[#2563eb]"></i>
                      <h3 class="text-lg font-medium">${s.type}</h3>
                    </div>
                    <p class="text-gray-700 leading-relaxed mb-4">${s.description}</p>
                    <div class="space-y-2 text-sm text-gray-600">
                      <div><span class="font-medium">Avg. Attended:</span> ${s.avgAttended} (from ${s.avgInvited} invited)</div>
                      <div><span class="font-medium">Avg. Opportunities:</span> ${s.avgOpps} (${s.avgOppAttended} conversion)</div>
                      <div><span class="font-medium">Avg. Closed-Won:</span> ${s.avgClosed} (${s.win} win rate)</div>
                    </div>
                    <div class="mt-4 pt-4 border-t border-gray-200">
                      <p class="text-sm font-medium text-[#2563eb]">Partner Advantage:</p>
                      <p class="text-sm text-gray-700">${s.benefit}</p>
                    </div>
                  </div>
                `).join('')}
              </div>
              <div class="mt-8 text-center">
                <p class="text-gray-700 leading-relaxed">These metrics demonstrate Recast's strength in event execution. Partner with us to leverage our demand gen expertise for your success.</p>
              </div>
            </div>
          </div>
        `;
      }
      function renderBusinessPlanContent() {
        let html = '';
        html += '<section class="mb-8">';
        html += '<h3 class="text-xl font-medium mb-4">1. EXECUTIVE SUMMARY</h3>';
        html += '<h4 class="text-lg font-medium mb-2">Vision</h4>';
        html += '<p class="text-gray-700 leading-relaxed mb-4">To jointly deliver intelligent, automated application and endpoint management solutions for enterprise customers in regulated industries by integrating Recast’s Application Workspace into CoreSecure’s managed compliance platform.</p>';
        html += '<h4 class="text-lg font-medium mb-2">Strategic Goals</h4>';
        html += '<ul class="space-y-3 mb-4">';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Expand joint enterprise footprint across Financial Services and Healthcare.</span></li>';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Increase Recast ARR by 60% year-over-year through CoreSecure-led managed services.</span></li>';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Position CoreSecure as a fully certified Strategic/Premier MSP across Application Workspace and Access Manager.</span></li>';
        html += '</ul>';
        html += '<h4 class="text-lg font-medium mb-2">Mutual Value</h4>';
        html += '<ul class="space-y-3">';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">For CoreSecure: Differentiation through integrated automation and compliance reporting, driving new managed service revenue.</span></li>';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">For Recast: Accelerated customer acquisition, deeper retention, and expansion into managed environments at scale.</span></li>';
        html += '</ul>';
        html += '</section>';
        html += '<section class="mb-8">';
        html += '<h3 class="text-xl font-medium mb-4">2. PARTNERSHIP OBJECTIVES</h3>';
        html += '<div class="overflow-x-auto">';
        html += '<table class="min-w-full divide-y divide-[#E2E8F0]">';
        html += '<thead><tr><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Focus Area</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">FY26 Goal</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Success Metric</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Owner</th></tr></thead>';
        html += '<tbody class="divide-y divide-[#E2E8F0]">';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Enablement</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Complete certification program for sales and technical teams</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">4 technical + 2 sales certifications completed</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Partner Enablement Lead</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Demand Generation</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Execute two co-branded campaigns per quarter</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">8 total campaigns</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Recast & Partner Marketing</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Revenue Growth</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Build $1.2M Recast ARR pipeline</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">50% partner-led, 50% co-sell</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Partner Sales Director</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Operational Excellence</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Streamline joint onboarding and renewals</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed"><30-day deployment cycle</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Recast CS & Partner Ops</td></tr>';
        html += '</tbody></table></div>';
        html += '</section>';
        html += '<section class="mb-8">';
        html += '<h3 class="text-xl font-medium mb-4">3. ENABLEMENT PLAN</h3>';
        html += '<div class="overflow-x-auto">';
        html += '<table class="min-w-full divide-y divide-[#E2E8F0]">';
        html += '<thead><tr><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Activity</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Timing</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Notes / CTA</th></tr></thead>';
        html += '<tbody class="divide-y divide-[#E2E8F0]">';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Sales Certification (Recast Academy)</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">January–February</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Enroll 2 CoreSecure sales reps</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Technical Certification (Workspace Delivery)</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">February–March</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Conduct hands-on enablement with Recast SE</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Demo Environment Setup</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">March</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Deploy joint demo tenant for App Workspace</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Partner Portal Access</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">April</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Activate CoreSecure in Recast portal with CRM integration</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">QBR Framework Implementation</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">April</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Define performance metrics and success tracking</td></tr>';
        html += '</tbody></table></div>';
        html += '</section>';
        html += '<section class="mb-8">';
        html += '<h3 class="text-xl font-medium mb-4">4. LEADS & DEAL REGISTRATION</h3>';
        html += '<div class="overflow-x-auto">';
        html += '<table class="min-w-full divide-y divide-[#E2E8F0]">';
        html += '<thead><tr><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Activity</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Timing</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Notes / CTA</th></tr></thead>';
        html += '<tbody class="divide-y divide-[#E2E8F0]">';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Salesforce integration and Partner of Record mapping</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">January</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Confirm partner setup for deal registration</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Register 5 qualified leads per quarter</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Quarterly</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Minimum deal size $25K ACV</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Weekly pipeline sync</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Ongoing</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Partner + Recast Channel Manager review</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Pre-sales and SE support request process</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">As needed</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Submit via Partner Portal form</td></tr>';
        html += '</tbody></table></div>';
        html += '</section>';
        html += '<section class="mb-8">';
        html += '<h3 class="text-xl font-medium mb-4">5. 12-MONTH PLAN: DEMAND GENERATION</h3>';
        html += '<div class="overflow-x-auto">';
        html += '<table class="min-w-full divide-y divide-[#E2E8F0]">';
        html += '<thead><tr><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Activity</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Month</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Notes / CTA</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Anticipated Spend</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Target Leads</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Conversion Rate</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Closed Revenue Outcome</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Services Outcome</th></tr></thead>';
        html += '<tbody class="divide-y divide-[#E2E8F0]">';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Co-branded Webinar: “Automating Intune Compliance”</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">February</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Target Financial Services IT leaders</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">$3,000</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">50</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">10%</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">$75,000</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">$20,000</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Customer Case Study</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">April</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">CoreSecure + BankOne success story</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">$2,000</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">N/A</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">N/A</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">$0</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Brand lift</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Regional Executive Roundtable</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">June</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Invite-only event in Chicago</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">$5,000</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">30</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">15%</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">$100,000</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">$30,000</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">LinkedIn Ad Campaign</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">August</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">6-week campaign targeting enterprise MSPs</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">$6,000</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">100</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">8%</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">$96,000</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">$15,000</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Year-End “Partner Powered” Webinar</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">November</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Highlight joint wins and prep renewals</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">$2,500</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">40</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">10%</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">$60,000</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">$10,000</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm font-medium">Totals</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed"></td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed"></td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">$18,500</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">220</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">11% (avg)</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">$331,000</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">$75,000</td></tr>';
        html += '</tbody></table></div>';
        html += '</section>';
        html += '<section class="mb-8">';
        html += '<h3 class="text-xl font-medium mb-4">6. QBR & EXECUTIVE ALIGNMENT</h3>';
        html += '<h4 class="text-lg font-medium mb-2">Initial QBR:</h4>';
        html += '<ul class="space-y-3 mb-4">';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Date: January 15</span></li>';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Topics: FY26 enablement baseline, pipeline setup, campaign calendar</span></li>';
        html += '</ul>';
        html += '<h4 class="text-lg font-medium mb-2">Quarterly QBR Schedule:</h4>';
        html += '<div class="overflow-x-auto">';
        html += '<table class="min-w-full divide-y divide-[#E2E8F0]">';
        html += '<thead><tr><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Quarter</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Month</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Key Focus</th></tr></thead>';
        html += '<tbody class="divide-y divide-[#E2E8F0]">';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Q1</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">March</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Certification completion and first pipeline review</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Q2</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">June</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Marketing ROI and new logo acquisition</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Q3</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">September</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Expansion and renewals</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Q4</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">December</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Annual review and FY27 planning</td></tr>';
        html += '</tbody></table></div>';
        html += '</section>';
        html += '<section class="mb-8">';
        html += '<h3 class="text-xl font-medium mb-4">7. QBR TEMPLATE</h3>';
        html += '<div class="overflow-x-auto">';
        html += '<table class="min-w-full divide-y divide-[#E2E8F0]">';
        html += '<thead><tr><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Section</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Content/Example</th></tr></thead>';
        html += '<tbody class="divide-y divide-[#E2E8F0]">';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Executive Summary</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Pipeline, ARR growth, key wins, challenges</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Enablement Progress</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Certifications completed, demo environment status</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Pipeline Review</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Opportunity stages, close rates, forecast accuracy</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Co-Marketing Performance</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Campaign reach, leads generated, ROI</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Customer Success</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Renewals, expansion accounts, support metrics</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Action Items</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Next steps, owners, and deadlines</td></tr>';
        html += '</tbody></table></div>';
        html += '</section>';
        html += '<section>';
        html += '<h3 class="text-xl font-medium mb-4">8. KEY CONTACTS</h3>';
        html += '<div class="overflow-x-auto">';
        html += '<table class="min-w-full divide-y divide-[#E2E8F0]">';
        html += '<thead><tr><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Role</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">Recast Software</th><th scope="col" class="px-6 py-3 text-left text-sm font-semibold">CoreSecure Systems</th></tr></thead>';
        html += '<tbody class="divide-y divide-[#E2E8F0]">';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Channel Director</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Jane Smith</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Michael Reed</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Partner Manager</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Alex Nguyen</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Sarah Lopez</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Sales Engineer</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">David Patel</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Andrew Clarke</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Marketing Lead</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Laura Chen</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Olivia Ruiz</td></tr>';
        html += '<tr><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Customer Success Manager</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Tom Williams</td><td class="px-6 py-4 text-sm text-gray-700 leading-relaxed">Rachel Kim</td></tr>';
        html += '</tbody></table></div>';
        html += '</section>';
        return html;
      }
      function renderEvaluationModal() {
        return `
          <div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 px-4" role="dialog" aria-modal="true" id="evaluationModal">
            <div class="relative max-w-3xl w-full bg-white rounded-2xl shadow-2xl p-8 max-h-[90vh] overflow-y-auto">
              <button class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 focus:outline-none" id="closeEvaluation">
                <i data-lucide="x" class="h-6 w-6"></i>
                <span class="sr-only">Close</span>
              </button>
              <h2 class="text-xl font-medium mb-6 flex items-center gap-3"><i data-lucide="scale" class="h-6 w-6 stroke-[#2563eb]"></i>Value/Preferred to Strategic/Premier Partner Evaluation Guide</h2>
              ${renderEvaluationGuideContent()}
            </div>
          </div>
        `;
      }
      function renderEvaluationGuideContent() {
        let html = '';
        html += '<p class="text-gray-700 leading-relaxed mb-6">When evaluating whether a Value/Preferred Partner is ready to advance to Strategic/Premier status, Recast looks at three key areas — Focus, Capability, and Commitment.<br>These criteria ensure we’re investing in partners that can truly scale with us, represent our brand effectively, and deliver measurable revenue outcomes.</p>';
        html += '<section class="mb-6">';
        html += '<h3 class="text-xl font-medium mb-3 flex items-center gap-2"><i data-lucide="target" class="h-5 w-5 stroke-[#2563eb]"></i>1. Focus — Are they aligned with Recast’s go-to-market direction?</h3>';
        html += '<p class="text-gray-700 leading-relaxed mb-4">We assess whether the partner’s business focus and customer base align with the markets and segments Recast wants to grow in.</p>';
        html += '<ul class="space-y-3">';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Do they specialize in the right customer segment (e.g., enterprise, mid-market, or public sector)?</span></li>';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Are they active in the industries or regions where Recast wants to expand?</span></li>';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Do they have core competencies that complement Recast’s product strengths (endpoint management, automation, workspace delivery, etc.)?</span></li>';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Are they targeting the functional buyers that align with Recast’s motion (IT Ops, Security, Endpoint, Workspace)?</span></li>';
        html += '</ul>';
        html += '</section>';
        html += '<section class="mb-6">';
        html += '<h3 class="text-xl font-medium mb-3 flex items-center gap-2"><i data-lucide="bar-chart" class="h-5 w-5 stroke-[#2563eb]"></i>2. Capability — Do they have the structure to scale with Recast?</h3>';
        html += '<p class="text-gray-700 leading-relaxed mb-4">We evaluate whether the partner has the resources, skills, and reach to build and grow a sustainable Recast practice.</p>';
        html += '<ul class="space-y-3">';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Do they have technical resources trained or able to support Recast deployments?</span></li>';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Do they have a dedicated sales team capable of positioning and selling Recast solutions?</span></li>';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Is there a marketing function that can run co-branded or joint campaigns?</span></li>';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Do they have customer reach in the accounts and regions Recast wants to penetrate?</span></li>';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Are they geographically positioned in areas where Recast needs stronger coverage?</span></li>';
        html += '</ul>';
        html += '</section>';
        html += '<section>';
        html += '<h3 class="text-xl font-medium mb-3 flex items-center gap-2"><i data-lucide="handshake" class="h-5 w-5 stroke-[#2563eb]"></i>3. Commitment — Are they invested in mutual growth and measurable results?</h3>';
        html += '<p class="text-gray-700 leading-relaxed mb-4">We confirm that the partner isn’t just opportunistic, but strategically committed to driving joint revenue and customer success.</p>';
        html += '<ul class="space-y-3">';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Have they committed to a defined revenue target or growth goal for Recast?</span></li>';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Are they showing year-over-year progress in pipeline creation and customer adoption?</span></li>';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Are they actively pursuing upsell, cross-sell, and expansion within existing customers?</span></li>';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Do they have joint business plans or defined KPIs aligned with Recast’s objectives?</span></li>';
        html += '<li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Are they investing in training, enablement, and certification to build long-term capability?</span></li>';
        html += '</ul>';
        html += '</section>';
        return html;
      }
      function renderCsvModal() {
        const sample = "Partner Name,Campaign Name/ID,Account Name (and Domain),First Name,Last Name,Email,Country,Source Type,Attribution Intent,Requested PoR (Y/N)\n";
        return `
          <div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 px-4" id="csvModal">
            <div class="relative max-w-3xl w-full bg-white rounded-2xl shadow-2xl p-8 max-h-[90vh] overflow-y-auto">
              <button class="absolute top-4 right-4 text-gray-600 hover:text-gray-900" id="closeCsvModal"><i data-lucide="x" class="h-6 w-6"></i></button>
              <h2 class="text-xl font-medium mb-4 flex items-center gap-3"><i data-lucide="upload" class="h-6 w-6 stroke-[#2563eb]"></i>CSV Upload SOP</h2>
              <ol class="list-decimal pl-6 space-y-2 text-gray-700">
                <li>Download the template CSV.</li>
                <li>Fill required columns; one row per contact.</li>
                <li>Choose “Create Deal Registration” for qualified rows.</li>
                <li>Channel approves within 2 business days (PoR + Tier applied).</li>
              </ol>
              <div class="mt-4">
                <pre class="bg-gray-50 p-3 rounded-lg text-xs overflow-auto">${sample}</pre>
              </div>
              <div class="mt-4 flex gap-2">
                <button class="rounded-full bg-[#2563eb] text-white px-4 py-2 text-sm" id="downloadCsvTpl">Download Template</button>
                <button class="rounded-full border px-4 py-2 text-sm" id="closeCsvModal2">Close</button>
              </div>
            </div>
          </div>`;
      }
      function renderLeadsGuideModal() {
        return `
          <div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 px-4" role="dialog" aria-modal="true" id="leadsGuideModal">
            <div class="relative max-w-4xl w-full bg-white rounded-2xl shadow-2xl p-8 max-h-[90vh] overflow-y-auto">
              <button class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 focus:outline-none" id="closeLeadsGuide">
                <i data-lucide="x" class="h-6 w-6"></i>
                <span class="sr-only">Close</span>
              </button>
              <h2 class="text-2xl font-semibold mb-6 text-center">Submit Leads, Get Credit, Win More Deals</h2>
              <p class="text-gray-700 leading-relaxed mb-8">To protect your deals and ensure you're recognized as the Partner of Record (POR), it's critical to submit leads through the right channels. When you register leads, we guarantee visibility — and we will not take those deals direct. Here’s how to submit leads based on your selling motion:</p>
              <div class="space-y-8">
                <section>
                  <h3 class="text-xl font-medium mb-4 flex items-center gap-2"><i data-lucide="file-plus" class="h-5 w-5 stroke-[#2563eb]"></i>1. Submitting One-Off Deals (Sales-Led)</h3>
                  <p class="text-gray-700 leading-relaxed mb-2"><strong>Use:</strong> Partner Portal Lead Registration Form</p>
                  <p class="text-gray-700 leading-relaxed mb-4"><strong>When to Use:</strong> For individual deals you’re actively working.</p>
                  <h4 class="text-lg font-medium mb-2">What to Do:</h4>
                  <ul class="space-y-3 mb-4">
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Go to the Partner Portal and complete the form</span></li>
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed"><strong>Required:</strong> First Name, Last Name, Business Email, Company Name, Country, Campaign Source (defaults to “Salesperson”)</span></li>
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">(Optional: Lead Notes or BANT)</span></li>
                  </ul>
                  <h4 class="text-lg font-medium mb-2">What to Get:</h4>
                  <ul class="space-y-3">
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Your lead is protected and entered into Salesforce</span></li>
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">You’re tagged as Partner of Record (POR) if it qualifies</span></li>
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Our team won’t engage the lead directly — it stays with you</span></li>
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Full transparency on conversion and pipeline status</span></li>
                  </ul>
                </section>
                <section>
                  <h3 class="text-xl font-medium mb-4 flex items-center gap-2"><i data-lucide="upload" class="h-5 w-5 stroke-[#2563eb]"></i>2. Uploading Leads from Webinars or Events</h3>
                  <p class="text-gray-700 leading-relaxed mb-2"><strong>Use:</strong> CSV Upload</p>
                  <p class="text-gray-700 leading-relaxed mb-4"><strong>When to Use:</strong> For leads collected at events, webinars, or campaigns.</p>
                  <h4 class="text-lg font-medium mb-2">What to Do:</h4>
                  <ul class="space-y-3 mb-4">
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Prepare your CSV with: First Name, Last Name, Business Email, Company Name, Country, Campaign Source (e.g., Webinar, Event), Partner Account</span></li>
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">(Optional: Lead Notes / BANT, Lead Owner, Lead Status, Date Created)</span></li>
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Submit via the upload tool</span></li>
                  </ul>
                  <h4 class="text-lg font-medium mb-2">What to Get:</h4>
                  <ul class="space-y-3">
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Your leads are attributed to your partner account and campaign</span></li>
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Qualified leads convert to opportunities with POR credit</span></li>
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Leads from Strategic/Premier/Strategic partners are never routed to direct sales</span></li>
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Event performance is tracked in Salesforce for visibility</span></li>
                  </ul>
                </section>
                <section>
                  <h3 class="text-xl font-medium mb-4 flex items-center gap-2"><i data-lucide="shield-check" class="h-5 w-5 stroke-[#2563eb]"></i>Why Registering Leads Matters</h3>
                  <p class="text-gray-700 leading-relaxed mb-4">When you register leads:</p>
                  <ul class="space-y-3 mb-4">
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">You’re protected as the Partner of Record</span></li>
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">We don’t pursue the deal directly</span></li>
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">You gain access to full-funnel visibility</span></li>
                    <li class="flex items-start gap-3"><div class="flex-shrink-0 mt-1 bg-[#2563eb] rounded-full p-1"><i data-lucide="check" class="h-3 w-3 stroke-white"></i></div><span class="text-gray-700 leading-relaxed">Your efforts are recognized in revenue reporting</span></li>
                  </ul>
                  <p class="text-gray-700 leading-relaxed">This process protects your deals, supports co-selling, and ensures you’re in the driver's seat.</p>
                </section>
              </div>
            </div>
          </div>
        `;
      }
      function renderStageModal() {
        const stage = STATE.salesCycle.stages[STATE.salesCycle.selectedStage];
        let left = STATE.salesCycle.modalPosition.left;
        if (left + 320 > window.innerWidth) {
          left = STATE.salesCycle.modalPosition.left - (left + 320 - window.innerWidth);
        }
        const style = `position: absolute; top: ${STATE.salesCycle.modalPosition.top}px; left: ${left}px;`;
        return `
          <div class="popout-panel open bg-white rounded-2xl shadow-lg w-80 transform scale-100 opacity-100 transition-all duration-200 ease-in-out z-50" style="${style}">
            <div class="p-6">
              <h2 class="text-xl font-medium mb-4">${stage.label}</h2>
              <div class="space-y-4 text-sm text-gray-700">
                <p><strong>Description:</strong> ${stage.description}</p>
                <p><strong>Entry Criteria:</strong> ${stage.entryCriteria.join(', ')}</p>
                <p><strong>Exit Criteria:</strong> ${stage.exitCriteria.join(', ')}</p>
                <p><strong>Deliverables:</strong> ${stage.deliverables.join(', ')}</p>
              </div>
            </div>
          </div>
        `;
      }
      function renderPartnersHelpModal() {
        return `
          <div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 px-4" role="dialog" aria-modal="true" id="partnersHelpModal">
            <div class="relative max-w-4xl w-full bg-white rounded-2xl shadow-2xl p-8 max-h-[90vh] overflow-y-auto">
              <button class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 focus:outline-none" id="closePartnersHelp">
                <i data-lucide="x" class="h-6 w-6"></i>
                <span class="sr-only">Close</span>
              </button>
              <h2 class="text-xl font-medium mb-6 flex items-center gap-3"><i data-lucide="users" class="h-6 w-6 stroke-[#2563eb]"></i>Partnering with Recast</h2>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div class="rounded-2xl bg-white p-6 shadow-md">
                  <h3 class="text-lg font-medium mb-4">Hybrid MSP / SI Partners</h3>
                  <h4 class="text-base font-medium mb-2">Challenges</h4>
                  <ul class="list-disc pl-5 space-y-1 text-gray-700 mb-4">
                    <li>Application layer blocks every initiative</li>
                    <li>Too much manual app work</li>
                    <li>Customer IT overwhelmed</li>
                    <li>Project timelines slip</li>
                  </ul>
                  <h4 class="text-base font-medium mb-2">Business Value</h4>
                  <ul class="list-disc pl-5 space-y-1 text-gray-700 mb-4">
                    <li>Scale without adding headcount</li>
                    <li>Increase ARR + project output</li>
                    <li>Faster, more predictable delivery</li>
                    <li>Stronger valuation via automation</li>
                  </ul>
                  <h4 class="text-base font-medium mb-2">Customer Impact</h4>
                  <ul class="list-disc pl-5 space-y-1 text-gray-700">
                    <li>Faster modernization + migration</li>
                    <li>Fewer app incidents</li>
                    <li>Clear path to readiness</li>
                    <li>More stable environments</li>
                  </ul>
                </div>
                <div class="rounded-2xl bg-white p-6 shadow-md">
                  <h3 class="text-lg font-medium mb-4">ISV / OEM Partners</h3>
                  <h4 class="text-base font-medium mb-2">Challenges</h4>
                  <ul class="list-disc pl-5 space-y-1 text-gray-700 mb-4">
                    <li>Application readiness stalls adoption</li>
                    <li>Pilots fail due to app gaps</li>
                    <li>Customers lack capacity</li>
                    <li>Sales motions slow down</li>
                  </ul>
                  <h4 class="text-base font-medium mb-2">Business Value</h4>
                  <ul class="list-disc pl-5 space-y-1 text-gray-700 mb-4">
                    <li>Faster pilots + rollouts</li>
                    <li>Higher win rates</li>
                    <li>Larger, stickier deployments</li>
                    <li>Predictable co-sell motions</li>
                  </ul>
                  <h4 class="text-base font-medium mb-2">Customer Impact</h4>
                  <ul class="list-disc pl-5 space-y-1 text-gray-700">
                    <li>Smooth onboarding</li>
                    <li>Lower deployment risk</li>
                    <li>Compatible applications</li>
                    <li>Faster value from the platform</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        `;
      }
      function renderInternalROEPopout() {
        return `
          <div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 px-4" role="dialog" aria-modal="true" id="internalROEPopout">
            <div class="relative max-w-4xl w-full bg-white rounded-2xl shadow-2xl p-8 max-h-[90vh] overflow-y-auto">
              <button class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 focus:outline-none" id="closeInternalROE">
                <i data-lucide="x" class="h-6 w-6"></i>
              </button>
              <h2 class="text-xl font-medium mb-6 flex items-center gap-3"><i data-lucide="file-text" class="h-6 w-6 stroke-[#2563eb]"></i>Internal ROE for Deal Registration</h2>
              <p class="text-gray-700 leading-relaxed whitespace-pre-line">${STATE.dealRegNotes.internal}</p>
              <h3 class="text-lg font-medium mt-6 mb-3">Summary</h3>
              <p class="text-gray-700 leading-relaxed whitespace-pre-line">${STATE.dealRegNotes.summary}</p>
            </div>
          </div>
        `;
      }
      function renderPartnerCommPopout() {
        return `
          <div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 px-4" role="dialog" aria-modal="true" id="partnerCommPopout">
            <div class="relative max-w-4xl w-full bg-white rounded-2xl shadow-2xl p-8 max-h-[90vh] overflow-y-auto">
              <button class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 focus:outline-none" id="closePartnerComm">
                <i data-lucide="x" class="h-6 w-6"></i>
              </button>
              <h2 class="text-xl font-medium mb-6 flex items-center gap-3"><i data-lucide="message-circle" class="h-6 w-6 stroke-[#2563eb]"></i>Partner Communication for Deal Registration</h2>
              <p class="text-gray-700 leading-relaxed whitespace-pre-line">${STATE.dealRegNotes.partner}</p>
              <h3 class="text-lg font-medium mt-6 mb-3">Summary</h3>
              <p class="text-gray-700 leading-relaxed whitespace-pre-line">${STATE.dealRegNotes.summary}</p>
            </div>
          </div>
        `;
      }
      function addEventListeners() {
        document.getElementById('partnerType').addEventListener('change', (e) => {
          STATE.partnerType = e.target.value;
          STATE.tier = setDefaultTier(STATE.partnerType);
          STATE.activeTier = setDefaultTier(STATE.partnerType);
          STATE.showMspOption = false; // Reset MSP toggle on type change
          if (STATE.partnerType === 'Program Overview') {
            STATE.activeTab = 'overview';
          }
          if (STATE.partnerType === 'Registered') {
            STATE.newPartner = false;
            if (['margins', 'onboarding'].includes(STATE.activeTab)) {
              STATE.activeTab = 'overview';
            }
          } else if (!getPartnerData(STATE.partnerType).isStandard && STATE.activeTab === 'margins') {
            STATE.activeTab = 'overview';
          }
          render();
        });
        document.querySelectorAll('[data-tab]:not([disabled])').forEach((btn) => {
          btn.addEventListener('click', () => {
            STATE.activeTab = btn.dataset.tab;
            render();
          });
        });
        const commitmentSelect = document.getElementById('commitment');
        if (commitmentSelect) {
          commitmentSelect.addEventListener('change', (e) => {
            STATE.commitment = e.target.value;
            render();
          });
        }
        const dealTypeSelect = document.getElementById('dealType');
        if (dealTypeSelect) {
          dealTypeSelect.addEventListener('change', (e) => {
            STATE.dealType = e.target.value;
            render();
          });
        }
        document.querySelectorAll('input[name="tier"]').forEach(radio => {
          radio.addEventListener('change', (e) => {
            STATE.tier = e.target.value;
            render();
          });
        });
        document.querySelectorAll('[data-step]').forEach((btn) => {
          btn.addEventListener('click', () => {
            STATE.activeStep = parseInt(btn.dataset.step);
            render();
          });
        });
        const businessPlanButton = document.getElementById('businessPlanButton');
        if (businessPlanButton) {
          businessPlanButton.addEventListener('click', () => {
            STATE.showBusinessPlanModal = true;
            render();
          });
        }
        const partnerEventsButton = document.getElementById('partnerEventsButton');
        if (partnerEventsButton) {
          partnerEventsButton.addEventListener('click', () => {
            STATE.showPartnerEventsModal = true;
            render();
          });
        }
        const evaluationButton = document.getElementById('evaluationButton');
        if (evaluationButton) {
          evaluationButton.addEventListener('click', () => {
            STATE.showEvaluationModal = true;
            render();
          });
        }
        const closeBusinessPlan = document.getElementById('closeBusinessPlan');
        if (closeBusinessPlan) {
          closeBusinessPlan.addEventListener('click', () => {
            STATE.showBusinessPlanModal = false;
            render();
          });
        }
        const closePartnerEvents = document.getElementById('closePartnerEvents');
        if (closePartnerEvents) {
          closePartnerEvents.addEventListener('click', () => {
            STATE.showPartnerEventsModal = false;
            render();
          });
        }
        const closeEvaluation = document.getElementById('closeEvaluation');
        if (closeEvaluation) {
          closeEvaluation.addEventListener('click', () => {
            STATE.showEvaluationModal = false;
            render();
          });
        }
        const exampleACVInput = document.getElementById('exampleACV');
        if (exampleACVInput) {
          exampleACVInput.addEventListener('input', (e) => {
            STATE.exampleACV = parseFloat(e.target.value) || 100000;
            render();
          });
        }
        document.querySelectorAll('[data-toggle]').forEach(btn => {
          btn.addEventListener('click', () => {
            STATE.roeView = btn.dataset.toggle;
            render();
          });
        });
        const csvSopBtn = document.getElementById('csvSopBtn');
        if (csvSopBtn) {
          csvSopBtn.addEventListener('click', () => {
            STATE.showCsvModal = true;
            render();
          });
        }
        const leadsGuideBtn = document.getElementById('leadsGuideBtn');
        if (leadsGuideBtn) {
          leadsGuideBtn.addEventListener('click', () => {
            STATE.showLeadsGuideModal = true;
            render();
          });
        }
        const closeLeadsGuide = document.getElementById('closeLeadsGuide');
        if (closeLeadsGuide) {
          closeLeadsGuide.addEventListener('click', () => {
            STATE.showLeadsGuideModal = false;
            render();
          });
        }
        const closeCsvModal = document.getElementById('closeCsvModal');
        const closeCsvModal2 = document.getElementById('closeCsvModal2');
        if (closeCsvModal) closeCsvModal.addEventListener('click', () => { STATE.showCsvModal = false; render(); });
        if (closeCsvModal2) closeCsvModal2.addEventListener('click', () => { STATE.showCsvModal = false; render(); });
        const downloadCsvTpl = document.getElementById('downloadCsvTpl');
        if (downloadCsvTpl) {
          downloadCsvTpl.addEventListener('click', () => {
            const csv = `Partner Name,Campaign Name/ID,Account Name (and Domain),First Name,Last Name,Email,Country,Source Type,Attribution Intent,Requested PoR (Y/N)\n`;
            const blob = new Blob([csv], {type: 'text/csv'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'recast_partner_upload_template.csv';
            a.click();
            URL.revokeObjectURL(url);
          });
        }
        const filterTrigger = document.getElementById('filterTrigger');
        if (filterTrigger) {
          filterTrigger.addEventListener('change', (e) => {
            STATE.filterModalOpen = e.target.checked;
            render();
          });
        }
        const selectAll = document.getElementById('selectAll');
        if (selectAll) {
          selectAll.addEventListener('change', (e) => {
            if (e.target.checked) {
              STATE.selectedPartnerTypes = PARTNER_TYPES.slice();
            } else {
              STATE.selectedPartnerTypes = [];
            }
            render();
          });
        }
        document.querySelectorAll('.partner-type-checkbox').forEach(cb => {
          cb.addEventListener('change', (e) => {
            const type = e.target.dataset.type;
            if (e.target.checked) {
              if (!STATE.selectedPartnerTypes.includes(type)) {
                STATE.selectedPartnerTypes.push(type);
              }
            } else {
              STATE.selectedPartnerTypes = STATE.selectedPartnerTypes.filter(t => t !== type);
            }
            render();
          });
        });
        const saveFilter = document.getElementById('saveFilter');
        if (saveFilter) {
          saveFilter.addEventListener('click', () => {
            if (STATE.selectedPartnerTypes.length === 0) {
              STATE.selectedPartnerTypes = PARTNER_TYPES.slice();
            }
            if (typeof localStorage !== 'undefined') {
              localStorage.setItem('recastPartnerTypeFilter', JSON.stringify({ selectedPartnerTypes: STATE.selectedPartnerTypes }));
            }
            STATE.filterModalOpen = false;
            render();
          });
        }
        const resetFilter = document.getElementById('resetFilter');
        if (resetFilter) {
          resetFilter.addEventListener('click', () => {
            STATE.selectedPartnerTypes = PARTNER_TYPES.slice();
            if (typeof localStorage !== 'undefined') {
              localStorage.setItem('recastPartnerTypeFilter', JSON.stringify({ selectedPartnerTypes: STATE.selectedPartnerTypes }));
            }
            STATE.filterModalOpen = false;
            render();
          });
        }
        const closeFilterModal = document.getElementById('closeFilterModal');
        if (closeFilterModal) {
          closeFilterModal.addEventListener('click', () => {
            STATE.filterModalOpen = false;
            render();
          });
        }
        const closeFilterModalBg = document.getElementById('filterModalBg');
        if (closeFilterModalBg) {
          closeFilterModalBg.addEventListener('click', (e) => {
            if (e.target === closeFilterModalBg) {
              STATE.filterModalOpen = false;
              render();
            }
          });
        }
        const mspToggle = document.getElementById('mspToggle');
        if (mspToggle) {
          mspToggle.addEventListener('change', (e) => {
            STATE.showMspOption = e.target.checked;
            render();
          });
        }
        document.querySelectorAll('[data-tier]').forEach(btn => {
          btn.addEventListener('click', () => {
            STATE.activeTier = btn.dataset.tier;
            render();
          });
        });
        document.querySelectorAll('[data-stage]').forEach(btn => {
          btn.addEventListener('click', () => {
            const rect = btn.getBoundingClientRect();
            STATE.salesCycle.modalPosition = { top: rect.bottom + window.scrollY, left: rect.left + window.scrollX };
            STATE.salesCycle.selectedStage = btn.dataset.stage;
            STATE.salesCycle.showStageModal = true;
            render();
          });
        });
        document.addEventListener('click', (e) => {
          if (STATE.salesCycle.showStageModal && !e.target.closest('.popout-panel') && !e.target.closest('[data-stage]')) {
            STATE.salesCycle.showStageModal = false;
            render();
          }
        });
        const partnersHelpButton = document.getElementById('partnersHelpButton');
        if (partnersHelpButton) {
          partnersHelpButton.addEventListener('click', () => {
            STATE.showPartnersHelpModal = true;
            render();
          });
        }
        const closePartnersHelp = document.getElementById('closePartnersHelp');
        if (closePartnersHelp) {
          closePartnersHelp.addEventListener('click', () => {
            STATE.showPartnersHelpModal = false;
            render();
          });
        }
        const internalROEButton = document.getElementById('internalROEButton');
        if (internalROEButton) {
          internalROEButton.addEventListener('click', () => {
            STATE.showInternalROEPopout = true;
            render();
          });
        }
        const closeInternalROE = document.getElementById('closeInternalROE');
        if (closeInternalROE) {
          closeInternalROE.addEventListener('click', () => {
            STATE.showInternalROEPopout = false;
            render();
          });
        }
        const partnerCommButton = document.getElementById('partnerCommButton');
        if (partnerCommButton) {
          partnerCommButton.addEventListener('click', () => {
            STATE.showPartnerCommPopout = true;
            render();
          });
        }
        const closePartnerComm = document.getElementById('closePartnerComm');
        if (closePartnerComm) {
          closePartnerComm.addEventListener('click', () => {
            STATE.showPartnerCommPopout = false;
            render();
          });
        }
        const dealRegButton = document.getElementById('dealRegButton');
        if (dealRegButton) {
          dealRegButton.addEventListener('click', () => {
            STATE.showDealRegModal = true;
            render();
          });
        }
        const closeDealReg = document.getElementById('closeDealReg');
        if (closeDealReg) {
          closeDealReg.addEventListener('click', () => {
            STATE.showDealRegModal = false;
            render();
          });
        }
        const modals = document.querySelectorAll('#businessPlanModal, #partnerEventsModal, #evaluationModal, #csvModal, #leadsGuideModal, #partnersHelpModal, #internalROEPopout, #partnerCommPopout, #dealRegModal');
        modals.forEach(m => {
          m.addEventListener('click', (e) => {
            if (e.target === m) {
              STATE.showBusinessPlanModal = false;
              STATE.showPartnerEventsModal = false;
              STATE.showEvaluationModal = false;
              STATE.showCsvModal = false;
              STATE.showLeadsGuideModal = false;
              STATE.showPartnersHelpModal = false;
              STATE.showInternalROEPopout = false;
              STATE.showPartnerCommPopout = false;
              STATE.showDealRegModal = false;
              render();
            }
          });
        });
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && (STATE.showBusinessPlanModal || STATE.showPartnerEventsModal || STATE.showEvaluationModal || STATE.showCsvModal || STATE.showLeadsGuideModal || STATE.filterModalOpen || STATE.salesCycle.showStageModal || STATE.showPartnersHelpModal || STATE.showInternalROEPopout || STATE.showPartnerCommPopout || STATE.showDealRegModal)) {
            STATE.showBusinessPlanModal = false;
            STATE.showPartnerEventsModal = false;
            STATE.showEvaluationModal = false;
            STATE.showCsvModal = false;
            STATE.showLeadsGuideModal = false;
            STATE.filterModalOpen = false;
            STATE.salesCycle.showStageModal = false;
            STATE.showPartnersHelpModal = false;
            STATE.showInternalROEPopout = false;
            STATE.showPartnerCommPopout = false;
            STATE.showDealRegModal = false;
            render();
          }
        });
      }
      document.addEventListener('DOMContentLoaded', () => {
        initFilter();
        render();
      });
    </script>
  </body>
</html>
