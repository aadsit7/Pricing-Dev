<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Recast + Microsoft Intune — Better Together</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;600;700;800;900&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            ink: '#0d1220',
            navy: '#0f172a',
            surface: '#111827',
            panel: '#0b1020',
            recastPurple: '#7c3aed',
            recastPurpleDark: '#5b21b6',
            recastCyan: '#06b6d4',
            recastYellow: '#facc15',
            slateA: '#94a3b8',
          },
          fontFamily: {
            sans: ['Inter', 'ui-sans-serif', 'system-ui', '-apple-system', 'Segoe UI', 'Roboto', 'Arial', 'sans-serif']
          },
          boxShadow: {
            soft: '0 10px 30px rgba(0,0,0,.35)',
            glow: '0 0 0 3px rgba(124,58,237,.35), 0 0 50px rgba(124,58,237,.25)',
            glowCyan: '0 0 0 3px rgba(6,182,212,.35), 0 0 50px rgba(6,182,212,.25)'
          },
          borderRadius: {
            '3xl': '1.5rem'
          }
        }
      }
    }
  </script>
  <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="min-h-screen bg-navy text-white font-sans antialiased selection:bg-recastPurple/30 selection:text-white">
  <header class="sticky top-0 z-30 border-b border-white/5 bg-navy/80 backdrop-blur">
    <div class="mx-auto max-w-6xl px-4 sm:px-6 py-4">
      <div class="flex items-center justify-between gap-4">
        <div class="flex items-center gap-3">
          <div class="grid h-9 w-9 place-items-center rounded-2xl bg-recastPurple/20 ring-1 ring-recastPurple/40">
            <i data-lucide="hexagon" class="h-5 w-5 text-recastPurple"></i>
          </div>
          <div>
            <h1 class="text-xl sm:text-2xl font-extrabold leading-none">Recast + Microsoft Intune</h1>
            <p class="text-xs text-slateA/90">Better Together — Application management that accelerates Intune adoption</p>
          </div>
        </div>
        <nav aria-label="Primary" class="flex items-center gap-2">
          <button id="tab-current" class="tab-btn" data-tab="current" aria-controls="view" aria-selected="true">
            <span class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full ring-1 ring-white/10 bg-white/10 text-[13px]">
              <i data-lucide="activity" class="h-4 w-4"></i> Current State
            </span>
          </button>
          <button id="tab-approach" class="tab-btn" data-tab="approach" aria-controls="view">
            <span class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full ring-1 ring-white/10 bg-white/5 text-[13px]">
              <i data-lucide="workflow" class="h-4 w-4"></i> Recast Approach
            </span>
          </button>
          <button id="tab-impact" class="tab-btn" data-tab="impact" aria-controls="view">
            <span class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full ring-1 ring-white/10 bg-white/5 text-[13px]">
              <i data-lucide="line-chart" class="h-4 w-4"></i> Impact & ROI
            </span>
          </button>
        </nav>
      </div>
    </div>
  </header>

  <main id="app" class="mx-auto max-w-6xl px-4 sm:px-6 py-6 md:py-8" role="main" aria-live="polite"></main>

  <div id="cdn-banner" class="hidden fixed bottom-4 left-1/2 z-50 w-[92vw] max-w-lg -translate-x-1/2 rounded-xl bg-rose-900/90 ring-1 ring-rose-600 px-4 py-3">
    <div class="flex items-start gap-2">
      <i data-lucide="alert-triangle" class="h-5 w-5"></i>
      <p class="text-sm">Some CDN assets failed to load. The page still works, but icons/styles may look different.</p>
    </div>
  </div>

  <script>
    // ===== STATE =====
    const STATE = {
      activeTab: 'current',
      metrics: {
        minutesSavedPerUser: 9,
        packagingHoursAvoided: 6,
        zeroDayHoursReduced: 0,
      },
      roi: {
        users: 5000,
        ticketsPerUserPerMonth: 0.035,
        avgHandleMins: 18,
        loadedCostPerHour: 85,
        recastAnnualCost: 120000
      },
      catalog: [
        { name: 'Microsoft 365', cat: 'Core Productivity' },
        { name: 'Teams', cat: 'Messaging' },
        { name: 'Edge', cat: 'Browsers' },
        { name: 'Chrome', cat: 'Browsers' },
        { name: 'Zoom', cat: 'Messaging' },
        { name: 'Slack', cat: 'Messaging' },
        { name: 'SAP', cat: 'Enterprise' },
        { name: 'Salesforce', cat: 'Enterprise' },
        { name: 'Adobe Reader', cat: 'Creative' },
        { name: 'Okta', cat: 'Security' },
        { name: 'VLC', cat: 'Utilities' },
        { name: 'Notepad++', cat: 'Utilities' }
      ],
      reducedMotion: window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches
    };

    // ===== HELPERS =====
    function el(tag, attrs = {}, children = []) {
      const node = document.createElement(tag);
      for (const [k, v] of Object.entries(attrs)) {
        if (k === 'class') node.className = v;
        else if (k === 'html') node.innerHTML = v;
        else node.setAttribute(k, v);
      }
      (Array.isArray(children) ? children : [children]).filter(Boolean).forEach(c => node.appendChild(typeof c === 'string' ? document.createTextNode(c) : c));
      return node;
    }
    function icon(name, cls = 'h-4 w-4') {
      const i = el('i', { 'data-lucide': name, class: cls });
      return i;
    }
    function fmt(num) {
      return num.toLocaleString();
    }
    function copyToClipboard(text) {
      return new Promise(async (resolve, reject) => {
        try {
          if (navigator.clipboard && window.isSecureContext) {
            await navigator.clipboard.writeText(text);
            resolve();
          } else {
            const ta = el('textarea', { style: 'position:absolute;left:-9999px;top:0;' });
            ta.value = text; document.body.appendChild(ta); ta.select();
            document.execCommand('copy'); document.body.removeChild(ta);
            resolve();
          }
        } catch (e) { reject(e); }
      });
    }

    // ===== RENDERERS =====
    function render() {
      const root = document.getElementById('app');
      root.innerHTML = '';
      root.appendChild(renderTabsSummary());

      if (STATE.activeTab === 'current') root.appendChild(renderCurrentState());
      if (STATE.activeTab === 'approach') root.appendChild(renderApproach());
      if (STATE.activeTab === 'impact') root.appendChild(renderImpact());

      try { window.lucide && window.lucide.createIcons(); } catch (_) {}
    }

    function renderTabsSummary() {
      const wrap = el('section', { class: 'mb-4 grid grid-cols-1 sm:grid-cols-3 gap-3' });

      const card = (label, value, toneClass, iconName, tooltip) => {
        return el('div', { class: 'rounded-2xl ring-1 ring-white/10 bg-white/5 px-4 py-3 flex items-center justify-between gap-3' }, [
          el('div', { class: 'flex items-center gap-2' }, [
            icon(iconName, 'h-4 w-4'),
            el('span', { class: 'text-sm text-slate-300' }, label)
          ]),
          el('div', { class: 'inline-flex items-center gap-2' }, [
            el('span', { class: `text-xs font-semibold rounded-full px-2 py-0.5 ${toneClass}`, title: tooltip || '' }, value)
          ])
        ]);
      };

      wrap.appendChild(card('Minutes saved (per user / mo)', STATE.metrics.minutesSavedPerUser, 'bg-emerald-400/10 ring-1 ring-emerald-400/50 text-emerald-200', 'timer'));
      wrap.appendChild(card('Packaging hours avoided', STATE.metrics.packagingHoursAvoided, 'bg-sky-400/10 ring-1 ring-sky-400/50 text-sky-200', 'package'));
      wrap.appendChild(card('Zero-day window reduced (hrs)', STATE.metrics.zeroDayHoursReduced, 'bg-yellow-400/10 ring-1 ring-yellow-400/50 text-yellow-200', 'shield-alert'));
      return wrap;
    }

    // --- CURRENT STATE ---
    function renderCurrentState() {
      const section = el('section', { 'aria-label': 'Current State', class: 'space-y-5' });

      section.appendChild(el('div', { class: 'rounded-3xl ring-1 ring-white/10 bg-white/5 p-4 md:p-5 shadow-soft' }, [
        el('h2', { class: 'text-lg md:text-xl font-bold mb-2 flex items-center gap-2' }, [icon('map'), 'Current State: Intune adoption stalls on apps']),
        el('div', { class: 'grid sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-3' }, [
          pill('Fragmented delivery', 'Windows / macOS / web — users guess the right way.', 'panel', 'columns-3', 'split-square-vertical'),
          pill('Packaging backlog', 'Rebuild per version; updates stall.', 'panel', 'columns-3', 'package-plus'),
          pill('Zero-day exposure', 'Patching takes days, not minutes.', 'panel', 'columns-3', 'alarm-clock'),
          pill('Slow upgrades', 'Stuck to old images; change is slow.', 'panel', 'columns-3', 'gauge')
        ]),
        el('p', { class: 'text-sm text-slateA' }, 'Too many apps, too many updates — IT can’t keep up. Systems drift and security risk grows. Intune projects slow or stall because application management isn’t solved.')
      ]));

      // Accordions
      const accGrid = el('div', { class: 'grid md:grid-cols-3 gap-4' });
      accGrid.appendChild(accordion('Why Change', [
        'Apps are the #1 bottleneck. Devices and policy don’t matter if apps aren’t packaged, patched, and proven.',
        'Thousands of apps, constant versions — IT can’t keep up, slowing adoption and raising risk.',
        'Innovation waits on apps: every transformation (cloud, security, AI) is delayed if app delivery isn’t solved.'
      ], 'alert-triangle'));

      accGrid.appendChild(accordion('Why Now', [
        'Faster change cycles: OS, SaaS, and AI tools update constantly — apps must keep pace.',
        'Rising risk: zero-days and compliance deadlines make manual patching unacceptable.',
        'Shrinking teams: capacity isn’t growing, but demand is. Automate or fall behind.'
      ], 'clock'));

      accGrid.appendChild(accordion('Why Recast', [
        'One platform for every app. Package, patch, and deliver from a single place into Intune.',
        'Proven scale. 7,000+ curated apps with automated updates slash manual effort.',
        'Fuel for Intune adoption. Remove app friction so migration and ongoing management move faster, safer, and with less risk.'
      ], 'sparkles'));

      section.appendChild(accGrid);
      return section;
    }

    function pill(title, desc, tone, cols, iconName) {
      return el('article', { class: 'rounded-2xl bg-white/5 ring-1 ring-white/10 p-4' }, [
        el('div', { class: 'flex items-center gap-2 mb-1.5' }, [icon(iconName, 'h-4 w-4 text-recastCyan'), el('h3', { class: 'text-sm font-semibold' }, title)]),
        el('p', { class: 'text-xs text-slateA leading-relaxed' }, desc)
      ]);
    }

    function accordion(title, bullets, iconName) {
      const root = el('section', { class: 'rounded-2xl overflow-hidden ring-1 ring-white/10 bg-white/5' });
      const btn = el('button', {
        class: 'w-full text-left bg-recastPurple/90 hover:bg-recastPurple focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 px-4 py-2.5 flex items-center justify-between'
      }, [
        el('div', { class: 'flex items-center gap-2' }, [icon(iconName, 'h-4 w-4'), el('span', { class: 'font-semibold' }, title)]),
        icon('chevron-down', 'h-4 w-4')
      ]);
      const panel = el('div', { class: 'p-4 space-y-2 bg-white/5' });
      const ul = el('ul', { class: 'list-disc pl-5 space-y-2 text-sm text-slate-200' });
      bullets.forEach(b => ul.appendChild(el('li', {}, b)));
      panel.appendChild(ul);
      root.appendChild(btn);
      root.appendChild(panel);
      panel.style.display = 'block';

      btn.addEventListener('click', () => {
        const open = panel.style.display !== 'none';
        panel.style.display = open ? 'none' : 'block';
      });
      return root;
    }

    // --- APPROACH ---
    function renderApproach() {
      const wrap = el('section', { class: 'space-y-5', 'aria-label': 'Recast Approach' });

      wrap.appendChild(el('div', { class: 'rounded-3xl ring-1 ring-white/10 bg-white/5 p-4 md:p-5 shadow-soft' }, [
        el('h2', { class: 'text-lg md:text-xl font-bold mb-1 flex items-center gap-2' }, [icon('workflow'), 'How Recast + Intune Work Together']),
        el('p', { class: 'text-sm text-slateA' }, 'Intune is the control plane. Recast is the application workspace that feeds Intune a curated catalog, automated patching, and delivery to the right users and devices — with rings, policy, and proof.')
      ]));

      // Workspace
      const grid = el('div', { class: 'grid lg:grid-cols-2 gap-4' });

      // Left: Application Workspace
      const left = el('section', { class: 'rounded-2xl ring-1 ring-white/10 bg-white/5 p-4' });
      left.appendChild(el('header', { class: 'flex items-center justify-between' }, [
        el('div', { class: 'flex items-center gap-2' }, [icon('app-window', 'h-5 w-5 text-recastCyan'), el('h3', { class: 'font-bold text-recastCyan' }, 'Application Workspace')]),
        el('div', { class: 'inline-flex items-center gap-1' }, [
          el('span', { class: 'text-[11px] rounded-full px-2 py-0.5 ring-1 ring-sky-400/60 bg-sky-400/10 text-sky-200' }, 'Curated & Secured')
        ])
      ]));

      // Catalog grid
      const catWrap = el('div', { class: 'mt-3 rounded-2xl bg-white/5 ring-1 ring-white/10 p-3' }, [
        el('div', { class: 'text-[11px] text-slate-300 mb-2' }, 'Catalog & Status'),
        el('div', { id: 'hexgrid', class: 'grid grid-cols-3 sm:grid-cols-4 gap-3' })
      ]);

      left.appendChild(catWrap);

      // Rings
      const rings = el('div', { class: 'mt-3 rounded-2xl bg-white/5 ring-1 ring-white/10 p-3' }, [
        el('div', { class: 'text-[11px] text-slate-300 mb-2' }, 'Staged Rings'),
        el('div', { id: 'rings', class: 'grid grid-cols-3 gap-2' })
      ]);
      left.appendChild(rings);

      // Platforms
      const plats = el('div', { class: 'mt-3 grid grid-cols-3 gap-2' }, [
        plat('Windows & macOS', 'computer'),
        plat('VDI', 'pc-case'),
        plat('Mobile', 'smartphone')
      ]);
      left.appendChild(plats);

      grid.appendChild(left);

      // Right: Intune outcomes + controls
      const right = el('section', { class: 'rounded-2xl ring-1 ring-white/10 bg-white/5 p-4 flex flex-col' });
      right.appendChild(el('header', { class: 'flex items-center justify-between' }, [
        el('div', { class: 'flex items-center gap-2' }, [icon('shield-check', 'h-5 w-5 text-emerald-300'), el('h3', { class: 'font-bold text-emerald-200' }, 'Intune Outcomes')]),
        el('div', { class: 'flex items-center gap-2' }, [
          button('Start', 'play', () => runWorkspaceDemo(), 'bg-recastCyan hover:brightness-110 ring-white/10 text-white'),
          button('Reset', 'rotate-ccw', () => buildWorkspace())
        ])
      ]));

      const outcomes = el('div', { id: 'outcomes', class: 'mt-3 space-y-3' });
      right.appendChild(outcomes);

      const note = el('p', { class: 'mt-auto text-[13px] text-slateA' }, 'Result: Complete, Intune-governed workspace on day one. Apps are delivered and patched automatically with proof of compliance.');
      right.appendChild(note);

      grid.appendChild(right);
      wrap.appendChild(grid);

      // Build interactive workspace
      setTimeout(buildWorkspace, 0);
      return wrap;
    }

    function plat(label, iconName) {
      return el('div', { class: 'rounded-xl ring-1 ring-white/10 bg-white/5 p-2.5 flex items-center gap-2' }, [icon(iconName, 'h-4 w-4'), el('span', { class: 'text-xs text-slate-200' }, label)]);
    }

    function button(label, iconName, onClick, cls = 'bg-white/10 hover:bg-white/15 ring-white/15 text-slate-100') {
      const b = el('button', { class: `inline-flex items-center gap-2 rounded-2xl px-3.5 py-2 text-sm font-semibold ${cls} focus:outline-none focus-visible:ring-2 focus-visible:ring-recastPurple` }, [icon(iconName, 'h-4 w-4'), el('span', {}, label)]);
      b.addEventListener('click', onClick);
      return b;
    }

    function buildWorkspace() {
      const grid = document.getElementById('hexgrid');
      const rings = document.getElementById('rings');
      const outcomes = document.getElementById('outcomes');
      if (!grid || !rings || !outcomes) return;

      grid.innerHTML = '';
      rings.innerHTML = '';
      outcomes.innerHTML = '';

      STATE.catalog.forEach(app => grid.appendChild(hexTile(app.name)));
      ['Business Unit', 'Subsidiary', 'Region'].forEach((t, i) => {
        const card = el('div', { class: 'rounded-xl ring-1 ring-white/10 p-3 bg-white/5' }, [
          el('div', { class: 'text-[11px] text-slate-300 mb-2' }, t),
          el('div', { class: 'h-2 rounded bg-white/10 overflow-hidden' }, el('div', { class: 'h-full w-0', style: 'background:linear-gradient(90deg, rgba(124,58,237,.9), rgba(6,182,212,.9));' }))
        ]);
        rings.appendChild(card);
      });

      outcomes.appendChild(metricRow('Compliance', '> 95%', 'shield-check', 'bg-emerald-400/10 ring-emerald-400/50 text-emerald-200'));
      outcomes.appendChild(metricRow('Time to value', 'Day 1', 'zap', 'bg-sky-400/10 ring-sky-400/50 text-sky-200'));
      outcomes.appendChild(metricRow('Change risk', 'Reduced', 'shield', 'bg-yellow-400/10 ring-yellow-400/50 text-yellow-200'));

      try { window.lucide && window.lucide.createIcons(); } catch (_) {}
    }

    function hexTile(label) {
      const fill = '#7c3aed';
      const btn = el('button', { class: 'group relative isolate inline-flex items-center justify-center aspect-[1.1547] w-full rounded-xl focus:outline-none focus-visible:ring-2 focus-visible:ring-white/80', 'aria-label': `${label}` });

      const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
      svg.setAttribute('viewBox', '0 0 100 86.6');
      svg.setAttribute('class', 'absolute inset-0 w-full h-full');

      const poly = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
      poly.setAttribute('points', '50,0 100,25 100,61.6 50,86.6 0,61.6 0,25');
      poly.setAttribute('fill', fill);
      poly.setAttribute('fill-opacity', '0.15');
      poly.setAttribute('stroke', fill);
      poly.setAttribute('stroke-opacity', '0.55');
      poly.setAttribute('stroke-width', '2');
      svg.appendChild(poly);

      const inner = el('div', { class: 'relative z-10 flex flex-col items-center justify-center text-center px-1' }, [
        icon('hexagon', 'h-4 w-4 mb-1'),
        el('div', { class: 'text-[11px] font-medium' }, label),
        el('span', { class: 'mt-1 text-[10px] rounded-full px-1.5 py-0.5 ring-1 ring-white/20 bg-white/10' }, 'Queued')
      ]);

      btn.appendChild(svg);
      btn.appendChild(inner);

      btn.addEventListener('click', () => {
        const badge = inner.querySelector('span');
        const i = inner.querySelector('i');
        const states = ['Queued', 'Provisioning', 'Patched', 'Updated'];
        const icons = ['hexagon', 'download', 'shield-check', 'refresh-ccw'];
        const next = (states.indexOf(badge.textContent) + 1) % states.length;
        badge.textContent = states[next];
        i.setAttribute('data-lucide', icons[next]);
        try { window.lucide.createIcons(); } catch (_) {}
      });

      return btn;
    }

    function metricRow(name, value, iconName, badgeClass) {
      return el('div', { class: 'rounded-2xl ring-1 ring-white/10 bg-white/5 px-4 py-3 flex items-center justify-between' }, [
        el('div', { class: 'flex items-center gap-2' }, [icon(iconName, 'h-4 w-4'), el('span', { class: 'text-sm text-slate-300' }, name)]),
        el('span', { class: `text-xs font-semibold rounded-full px-2 py-0.5 ring-1 ${badgeClass}` }, value)
      ]);
    }

    function runWorkspaceDemo() {
      if (STATE.reducedMotion) return;
      const rings = document.querySelectorAll('#rings > div > div > div');
      rings.forEach((bar, i) => {
        bar.style.width = '0%';
        setTimeout(() => { bar.style.transition = 'width 900ms ease'; bar.style.width = ['70%','86%','95%'][i]; }, 60 * i);
      });

      const tiles = Array.from(document.querySelectorAll('#hexgrid button'));
      tiles.forEach((t, i) => setTimeout(() => t.click(), 90 * i));

      const out = document.getElementById('outcomes');
      out.classList.add('shadow-glow');
      setTimeout(() => out.classList.remove('shadow-glow'), 1200);
    }

    // --- IMPACT & ROI ---
    function renderImpact() {
      const wrap = el('section', { class: 'space-y-5', 'aria-label': 'Impact & ROI' });

      // Summary strip
      wrap.appendChild(el('div', { class: 'grid md:grid-cols-4 gap-3' }, [
        kpi('Hours saved / mo', calcResults().hoursSavedPerMonth),
        kpi('$ saved / yr', `$${fmt(calcResults().dollarsSavedPerYear)}`, 'banknote'),
        kpi('ROI', `${fmt(calcResults().roiPct)}%`, 'percent'),
        kpi('Tickets / mo', calcResults().ticketsPerMonth, 'rocket')
      ]));

      // Assumptions form
      const form = el('form', { class: 'rounded-3xl ring-1 ring-white/10 bg-white/5 p-4 md:p-5 grid lg:grid-cols-2 gap-5' });
      form.appendChild(el('div', {}, [
        el('h3', { class: 'font-bold text-lg mb-3 flex items-center gap-2' }, [icon('sliders-horizontal'), 'Assumptions']),
        inputRow('# users', 'users', 'number', STATE.roi.users),
        inputRow('Tickets per user / mo', 'ticketsPerUserPerMonth', 'number', STATE.roi.ticketsPerUserPerMonth, 'step="0.001"'),
        inputRow('Avg handle (mins)', 'avgHandleMins', 'number', STATE.roi.avgHandleMins),
        inputRow('Loaded cost ($/hr)', 'loadedCostPerHour', 'number', STATE.roi.loadedCostPerHour),
        inputRow('Recast annual cost ($)', 'recastAnnualCost', 'number', STATE.roi.recastAnnualCost),
        el('p', { class: 'mt-2 text-[13px] text-slateA' }, 'Values are examples. Replace with your data.')
      ]));

      // Results
      const res = el('div', { class: 'space-y-4' });
      res.appendChild(el('h3', { class: 'font-bold text-lg flex items-center gap-2' }, [icon('receipt'), 'Results']));
      const box = el('div', { id: 'resultsBox', class: 'rounded-2xl ring-1 ring-white/10 bg-white/5 p-4 space-y-2' });
      res.appendChild(box);

      const ctaWrap = el('div', { class: 'flex items-center gap-2' }, [
        button('Reset', 'refresh-ccw', () => { STATE.roi = { users: 5000, ticketsPerUserPerMonth: 0.035, avgHandleMins: 18, loadedCostPerHour: 85, recastAnnualCost: 120000 }; render(); }),
        button('Copy executive one-pager', 'clipboard-copy', async () => {
          const r = calcResults();
          const text = [
            'Recast + Microsoft Intune — Executive Summary',
            '',
            'Why application management drives Intune adoption:',
            '- Apps are the #1 bottleneck to migration and ongoing management.',
            '- Recast delivers and patches applications automatically into Intune with rings and proof.',
            '- Result: faster rollouts, higher compliance, less risk, and measurable time savings.',
            '',
            'Impact (illustrative):',
            `• Hours saved / month: ${fmt(r.hoursSavedPerMonth)}`,
            `• $ saved / year: $${fmt(r.dollarsSavedPerYear)}`,
            `• ROI: ${fmt(r.roiPct)}%`,
            `• Tickets / month: ${fmt(r.ticketsPerMonth)}`,
            '',
            'Assumptions:',
            JSON.stringify(STATE.roi, null, 2)
          ].join('\n');
          try { await copyToClipboard(text); toast('Copied summary to clipboard.'); } catch { toast('Copy failed.'); }
        }, 'bg-recastYellow text-black hover:brightness-110 ring-white/10')
      ]);
      res.appendChild(ctaWrap);

      form.appendChild(res);
      wrap.appendChild(form);

      updateResultsBox();
      return wrap;
    }

    function kpi(label, value, iconName = 'timer') {
      return el('div', { class: 'rounded-2xl ring-1 ring-white/10 bg-white/5 px-4 py-3 flex items-center justify-between' }, [
        el('div', { class: 'flex items-center gap-2' }, [icon(iconName, 'h-4 w-4'), el('span', { class: 'text-sm text-slate-300' }, label)]),
        el('span', { class: 'text-base font-semibold' }, typeof value === 'number' ? fmt(value) : value)
      ]);
    }

    function inputRow(label, key, type, value, extraAttr = '') {
      const id = `f_${key}`;
      const r = el('div', { class: 'mb-2' }, [
        el('label', { for: id, class: 'block text-[13px] text-slate-300 mb-1' }, label),
        el('input', { id, type, value, class: 'w-full rounded-xl bg-navy/60 ring-1 ring-white/10 px-3 py-2 text-sm outline-none focus-visible:ring-2 focus-visible:ring-recastPurple', ...(extraAttr ? { extraAttr } : {}) })
      ]);
      setTimeout(() => {
        const input = r.querySelector('input');
        input.addEventListener('change', () => {
          const v = Number(input.value);
          if (Number.isFinite(v)) { STATE.roi[key] = v; updateResultsBox(); }
        });
      }, 0);
      return r;
    }

    function calcResults() {
      const r = STATE.roi;
      const minutesSaved = STATE.metrics.minutesSavedPerUser; // per user / month
      const hoursSavedFromUsers = (r.users * minutesSaved) / 60;
      const ticketsPerMonth = Math.round(r.users * r.ticketsPerUserPerMonth);
      const hoursFromTickets = (ticketsPerMonth * r.avgHandleMins) / 60 * 0.3; // assume 30% avoided due to automation
      const hoursSavedPerMonth = Math.round(hoursSavedFromUsers + hoursFromTickets);
      const dollarsPerHour = r.loadedCostPerHour;
      const dollarsSavedPerMonth = Math.round(hoursSavedPerMonth * dollarsPerHour);
      const dollarsSavedPerYear = dollarsSavedPerMonth * 12;
      const netBenefit = dollarsSavedPerYear - r.recastAnnualCost;
      const roiPct = Math.round((netBenefit / r.recastAnnualCost) * 100);
      return {
        hoursSavedPerMonth,
        dollarsSavedPerMonth,
        dollarsSavedPerYear,
        netBenefit,
        roiPct,
        ticketsPerMonth
      };
    }

    function updateResultsBox() {
      const box = document.getElementById('resultsBox');
      if (!box) return;
      const r = calcResults();
      box.innerHTML = '';
      const rows = [
        ['Hours saved / month', fmt(r.hoursSavedPerMonth)],
        ['$ saved / month', `$${fmt(r.dollarsSavedPerMonth)}`],
        ['$ saved / year', `$${fmt(r.dollarsSavedPerYear)}`],
        ['Net benefit / year', `$${fmt(r.netBenefit)}`],
        ['ROI', `${fmt(r.roiPct)}%`],
        ['Equivalent IT FTEs freed', (r.hoursSavedPerMonth / (160)).toFixed(2)]
      ];
      rows.forEach(([k, v]) => {
        box.appendChild(el('div', { class: 'flex items-center justify-between rounded-xl bg-white/5 ring-1 ring-white/10 px-3 py-2' }, [
          el('span', { class: 'text-sm text-slate-300' }, k),
          el('span', { class: 'text-sm font-semibold' }, v)
        ]));
      });
    }

    // ===== NAV =====
    function bindTabs() {
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          STATE.activeTab = btn.dataset.tab;
          document.querySelectorAll('header nav button span').forEach(s => s.classList.replace('bg-white/10', 'bg-white/5'));
          btn.querySelector('span').classList.replace('bg-white/5', 'bg-white/10');
          render();
        });
      });
    }

    function toast(msg) {
      const bar = el('div', { class: 'fixed bottom-4 left-1/2 -translate-x-1/2 z-50 rounded-xl bg-emerald-900/90 ring-1 ring-emerald-600 px-4 py-2 text-sm' }, msg);
      document.body.appendChild(bar);
      setTimeout(() => bar.remove(), 2200);
    }

    // ===== INIT =====
    function checkCDNs() {
      let fail = false;
      if (typeof tailwind === 'undefined') fail = true;
      if (!window.lucide) fail = true;
      if (fail) document.getElementById('cdn-banner').classList.remove('hidden');
    }

    document.addEventListener('DOMContentLoaded', () => {
      bindTabs();
      render();
      setTimeout(() => { try { window.lucide && window.lucide.createIcons(); } catch(_){} }, 50);
      setTimeout(checkCDNs, 800);
    });
  </script>

  <style>
    /* small progressive enhancement for tab buttons, kept inline to remain single-file */
    .tab-btn:focus-visible span { outline: 2px solid rgba(255,255,255,.7); outline-offset: 2px; }
  </style>
</body>
</html>
