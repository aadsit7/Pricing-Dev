<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Recast + Microsoft Intune — Better Together</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;600;700;800;900&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            base: '#0B1220',
            panel: '#0E1628',
            line: 'rgba(255,255,255,.08)',
            textDim: '#9aa5b1',
            purple: '#7c3aed',
            purpleDeep: '#5b21b6',
            cyan: '#06b6d4',
            yellow: '#facc15'
          },
          fontFamily: { sans: ['Inter', 'ui-sans-serif', 'system-ui', '-apple-system', 'Segoe UI', 'Roboto', 'Arial', 'sans-serif'] },
          boxShadow: {
            card: '0 10px 28px rgba(0,0,0,.35)',
            glowPurple: '0 0 0 3px rgba(124,58,237,.35), 0 0 40px rgba(124,58,237,.25)',
            glowCyan: '0 0 0 3px rgba(6,182,212,.35), 0 0 40px rgba(6,182,212,.25)'
          },
          borderRadius: { '3xl': '1.5rem' }
        }
      }
    };
  </script>
  <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="min-h-screen bg-base text-white font-sans antialiased selection:bg-purple/30 selection:text-white">
  <header class="sticky top-0 z-30 border-b border-line bg-base/85 backdrop-blur">
    <div class="mx-auto max-w-6xl px-4 sm:px-6 py-4">
      <div class="flex items-center justify-between gap-4">
        <div class="flex items-center gap-3">
          <div class="grid h-9 w-9 place-items-center rounded-2xl bg-purple/20 ring-1 ring-purple/40">
            <i data-lucide="hexagon" class="h-5 w-5 text-purple"></i>
          </div>
          <div>
            <h1 class="text-xl sm:text-2xl font-extrabold leading-none">Recast + Microsoft Intune</h1>
            <p class="text-xs text-textDim">Better Together • Application management accelerates Intune adoption</p>
          </div>
        </div>
        <nav id="tabs" aria-label="Primary" class="flex items-center gap-2">
          <button class="tab" data-tab="current" aria-controls="view" aria-selected="true">
            <span class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full ring-1 ring-line bg-white/10 text-[13px]">
              <i data-lucide="activity" class="h-4 w-4"></i> Current State
            </span>
          </button>
          <button class="tab" data-tab="approach" aria-controls="view" aria-selected="false">
            <span class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full ring-1 ring-line bg-white/5 text-[13px]">
              <i data-lucide="workflow" class="h-4 w-4"></i> Recast Approach
            </span>
          </button>
          <button class="tab" data-tab="impact" aria-controls="view" aria-selected="false">
            <span class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full ring-1 ring-line bg-white/5 text-[13px]">
              <i data-lucide="line-chart" class="h-4 w-4"></i> Impact & ROI
            </span>
          </button>
        </nav>
      </div>
    </div>
  </header>

  <main id="app" class="mx-auto max-w-6xl px-4 sm:px-6 py-6 md:py-8" role="main" aria-live="polite"></main>

  <div id="cdn-banner" class="hidden fixed bottom-4 left-1/2 z-50 w-[92vw] max-w-lg -translate-x-1/2 rounded-xl bg-rose-900/90 ring-1 ring-rose-600 px-4 py-3">
    <div class="flex items-start gap-2">
      <i data-lucide="alert-triangle" class="h-5 w-5"></i>
      <p class="text-sm">Some CDN assets failed to load. The page still works, but icons/styles may look different.</p>
    </div>
  </div>

  <script>
    // ========= GLOBAL STATE =========
    const STATE = {
      activeTab: 'current',
      reducedMotion: window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches,
      metrics: { minutesPerUser: 9, packagingHours: 6, zeroDayHours: 0 },
      roi: { users: 5000, ticketsPerUserPerMonth: 0.035, avgHandleMins: 18, loadedCostPerHour: 85, recastAnnualCost: 120000 },
      catalog: [
        { name: 'Microsoft 365', cat: 'Core Productivity' },
        { name: 'Teams', cat: 'Messaging' },
        { name: 'Edge', cat: 'Browsers' },
        { name: 'Chrome', cat: 'Browsers' },
        { name: 'Zoom', cat: 'Messaging' },
        { name: 'Slack', cat: 'Messaging' },
        { name: 'SAP', cat: 'Enterprise' },
        { name: 'Salesforce', cat: 'Enterprise' },
        { name: 'Adobe Reader', cat: 'Creative' },
        { name: 'Okta', cat: 'Security' },
        { name: 'VLC', cat: 'Utilities' },
        { name: 'Notepad++', cat: 'Utilities' }
      ]
    };

    // ========= HELPERS =========
    function el(tag, attrs = {}, children = []) {
      const node = document.createElement(tag);
      for (const [k, v] of Object.entries(attrs)) {
        if (k === 'class') node.className = v;
        else if (k === 'html') node.innerHTML = v;
        else if (k === 'text') node.textContent = v;
        else node.setAttribute(k, v);
      }
      (Array.isArray(children) ? children : [children]).filter(Boolean).forEach(c => node.appendChild(typeof c === 'string' ? document.createTextNode(c) : c));
      return node;
    }
    function icon(name, cls = 'h-4 w-4') { return el('i', { 'data-lucide': name, class: cls }); }
    function fmt(num) { return Number(num).toLocaleString(); }
    function safeLucide() { try { window.lucide && window.lucide.createIcons(); } catch (_) {} }
    function field(id) { return document.getElementById(id); }

    // ========= ROOT RENDER =========
    function render() {
      const root = field('app');
      root.innerHTML = '';
      root.appendChild(renderSummaryStrip());

      if (STATE.activeTab === 'current') root.appendChild(renderCurrentState());
      if (STATE.activeTab === 'approach') root.appendChild(renderApproach());
      if (STATE.activeTab === 'impact') root.appendChild(renderImpact());

      safeLucide();
    }

    // Top metric strip (consistent across tabs)
    function renderSummaryStrip() {
      const wrap = el('section', { class: 'mb-4 grid grid-cols-1 sm:grid-cols-3 gap-3' });
      wrap.appendChild(metricCard('Minutes saved (per user / mo)', STATE.metrics.minutesPerUser, 'timer', 'bg-emerald-400/10 ring-emerald-400/50 text-emerald-200'));
      wrap.appendChild(metricCard('Packaging hours avoided', STATE.metrics.packagingHours, 'package', 'bg-cyan-400/10 ring-1 ring-cyan-400/50 text-cyan-200'));
      wrap.appendChild(metricCard('Zero-day window reduced (hrs)', STATE.metrics.zeroDayHours, 'shield-alert', 'bg-yellow/10 ring-1 ring-yellow/50 text-yellow-200'));
      return wrap;
    }
    function metricCard(label, value, iconName, toneClass) {
      return el('div', { class: 'rounded-2xl ring-1 ring-line bg-white/5 px-4 py-3 flex items-center justify-between' }, [
        el('div', { class: 'flex items-center gap-2' }, [icon(iconName), el('span', { class: 'text-sm text-slate-300' }, label)]),
        el('span', { class: `text-xs font-semibold rounded-full px-2 py-0.5 ${toneClass}` }, typeof value === 'number' ? fmt(value) : value)
      ]);
    }

    // ========= VIEW: CURRENT STATE =========
    function renderCurrentState() {
      const view = el('section', { class: 'space-y-5', 'aria-label': 'Current State' });

      const hero = el('div', { class: 'rounded-3xl ring-1 ring-line bg-white/5 p-4 md:p-5 shadow-card' }, [
        el('h2', { class: 'text-lg md:text-xl font-bold mb-2 flex items-center gap-2' }, [icon('map'), 'Current State: Intune adoption stalls on apps']),
        el('div', { class: 'grid sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-3' }, [
          pill('Fragmented delivery', 'Windows / macOS / Web — users guess the right way.', 'split-square-vertical'),
          pill('Packaging backlog', 'Rebuild per version; updates stall.', 'package-plus'),
          pill('Zero-day exposure', 'Patching takes days, not minutes.', 'alarm-clock'),
          pill('Slow upgrades', 'Stuck to old images; change is slow.', 'gauge')
        ]),
        el('p', { class: 'text-sm text-textDim' }, 'Too many apps and too many updates — IT can’t keep up. Without modern application management, Intune projects slow or stall and risk grows.')
      ]);
      view.appendChild(hero);

      const grid = el('div', { class: 'grid md:grid-cols-3 gap-4' });
      grid.appendChild(accordion('Why Change', [
        'Apps are the #1 bottleneck. Devices and policy don’t matter if apps aren’t packaged, patched, and proven.',
        'Constant version churn across thousands of apps slows IT and raises risk.',
        'Every transformation (cloud, security, AI) waits until app delivery is solved.'
      ], 'alert-triangle'));
      grid.appendChild(accordion('Why Now', [
        'OS, SaaS, and AI tools update faster than ever — manual work can’t keep pace.',
        'Zero-days and compliance deadlines make slow patching unacceptable.',
        'Teams are shrinking — automation is the only lever left.'
      ], 'clock'));
      grid.appendChild(accordion('Why Recast + Intune', [
        'One platform for every app: package, patch, and deliver directly into Intune.',
        'Proven scale with 7,000+ curated apps and automated updates.',
        'Removes app friction, accelerating Intune migration and ongoing management.'
      ], 'sparkles'));
      view.appendChild(grid);

      return view;
    }
    function pill(title, desc, iconName) {
      return el('article', { class: 'rounded-2xl bg-white/5 ring-1 ring-line p-4' }, [
        el('div', { class: 'flex items-center gap-2 mb-1.5' }, [icon(iconName, 'h-4 w-4 text-cyan'), el('h3', { class: 'text-sm font-semibold' }, title)]),
        el('p', { class: 'text-xs text-textDim leading-relaxed' }, desc)
      ]);
    }
    function accordion(title, bullets, iconName) {
      const root = el('section', { class: 'rounded-2xl overflow-hidden ring-1 ring-line bg-white/5' });
      const btn = el('button', {
        class: 'w-full text-left bg-purple hover:bg-purpleDeep focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 px-4 py-2.5 flex items-center justify-between'
      }, [
        el('div', { class: 'flex items-center gap-2' }, [icon(iconName), el('span', { class: 'font-semibold' }, title)]),
        icon('chevron-down')
      ]);
      const panel = el('div', { class: 'p-4 space-y-2 bg-white/5' });
      const ul = el('ul', { class: 'list-disc pl-5 space-y-2 text-sm text-slate-200' });
      bullets.forEach(b => ul.appendChild(el('li', {}, b)));
      panel.appendChild(ul);
      root.appendChild(btn);
      root.appendChild(panel);
      panel.style.display = 'block';
      btn.addEventListener('click', () => { panel.style.display = panel.style.display === 'none' ? 'block' : 'none'; });
      return root;
    }

    // ========= VIEW: APPROACH =========
    function renderApproach() {
      const view = el('section', { class: 'space-y-5', 'aria-label': 'Recast Approach' });

      view.appendChild(el('div', { class: 'rounded-3xl ring-1 ring-line bg-white/5 p-4 md:p-5 shadow-card' }, [
        el('h2', { class: 'text-lg md:text-xl font-bold mb-1 flex items-center gap-2' }, [icon('workflow'), 'How Recast + Intune Work Together']),
        el('p', { class: 'text-sm text-textDim' }, 'Intune is the control plane. Recast is the application workspace that feeds Intune a curated catalog, automated patching, and targeted delivery with rings, policy, and proof.')
      ]));

      const grid = el('div', { class: 'grid lg:grid-cols-2 gap-4' });

      // Workspace (left)
      const left = el('section', { class: 'rounded-2xl ring-1 ring-line bg-white/5 p-4' });
      left.appendChild(el('header', { class: 'flex items-center justify-between' }, [
        el('div', { class: 'flex items-center gap-2' }, [icon('app-window', 'h-5 w-5 text-cyan'), el('h3', { class: 'font-bold text-cyan' }, 'Application Workspace')]),
        el('span', { class: 'text-[11px] rounded-full px-2 py-0.5 ring-1 ring-cyan/60 bg-cyan/10 text-cyan-200' }, 'Curated & Secured')
      ]));

      left.appendChild(el('div', { class: 'mt-3 rounded-2xl bg-white/5 ring-1 ring-line p-3' }, [
        el('div', { class: 'text-[11px] text-slate-300 mb-2' }, 'Catalog & Status'),
        el('div', { id: 'hexgrid', class: 'grid grid-cols-3 sm:grid-cols-4 gap-3' })
      ]));

      left.appendChild(el('div', { class: 'mt-3 rounded-2xl bg-white/5 ring-1 ring-line p-3' }, [
        el('div', { class: 'text-[11px] text-slate-300 mb-2' }, 'Staged Rings'),
        el('div', { id: 'rings', class: 'grid grid-cols-3 gap-2' })
      ]));

      left.appendChild(el('div', { class: 'mt-3 grid grid-cols-3 gap-2' }, [
        platformPill('Windows & macOS', 'computer'),
        platformPill('VDI', 'pc-case'),
        platformPill('Mobile', 'smartphone')
      ]));

      grid.appendChild(left);

      // Outcomes (right)
      const right = el('section', { class: 'rounded-2xl ring-1 ring-line bg-white/5 p-4 flex flex-col' });
      right.appendChild(el('header', { class: 'flex items-center justify-between' }, [
        el('div', { class: 'flex items-center gap-2' }, [icon('shield-check', 'h-5 w-5 text-emerald-300'), el('h3', { class: 'font-bold text-emerald-200' }, 'Intune Outcomes')]),
        el('div', { class: 'flex items-center gap-2' }, [
          primaryBtn('Start', 'play', () => workspaceDemo(), 'bg-cyan'),
          secondaryBtn('Reset', 'rotate-ccw', () => buildWorkspace())
        ])
      ]));

      right.appendChild(el('div', { id: 'outcomes', class: 'mt-3 space-y-3' }));
      right.appendChild(el('p', { class: 'mt-auto text-[13px] text-textDim' }, 'Result: Complete, Intune-governed workspace on day one. Apps delivered and patched automatically with proof of compliance.'));

      grid.appendChild(right);
      view.appendChild(grid);

      // Build interactive area NOW
      setTimeout(buildWorkspace, 0);
      return view;
    }

    function platformPill(label, iconName) {
      return el('div', { class: 'rounded-xl ring-1 ring-line bg-white/5 p-2.5 flex items-center gap-2' }, [icon(iconName), el('span', { class: 'text-xs text-slate-200' }, label)]);
    }
    function primaryBtn(label, iconName, onClick, bg = 'bg-white/10') {
      const b = el('button', { class: `inline-flex items-center gap-2 rounded-2xl px-3.5 py-2 text-sm font-semibold ${bg} hover:brightness-110 ring-1 ring-line focus:outline-none focus-visible:ring-2 focus-visible:ring-purple` }, [icon(iconName), el('span', {}, label)]);
      b.addEventListener('click', onClick);
      return b;
    }
    function secondaryBtn(label, iconName, onClick) {
      return primaryBtn(label, iconName, onClick, 'bg-white/10');
    }

    function buildWorkspace() {
      const grid = field('hexgrid');
      const rings = field('rings');
      const outs = field('outcomes');
      if (!grid || !rings || !outs) return;

      grid.innerHTML = '';
      rings.innerHTML = '';
      outs.innerHTML = '';

      // Catalog tiles
      STATE.catalog.forEach(app => grid.appendChild(hexTile(app.name)));

      // Rings
      ['Business Unit', 'Subsidiary', 'Region'].forEach((label) => {
        const card = el('div', { class: 'rounded-xl ring-1 ring-line p-3 bg-white/5' }, [
          el('div', { class: 'text-[11px] text-slate-300 mb-2' }, label),
          el('div', { class: 'h-2 rounded bg-white/10 overflow-hidden' }, el('div', { class: 'h-full w-0', style: 'background:linear-gradient(90deg, rgba(124,58,237,.95), rgba(6,182,212,.95));' }))
        ]);
        rings.appendChild(card);
      });

      // Outcome metrics
      outs.appendChild(metricCard('Compliance', '> 95%', 'shield-check', 'bg-emerald-400/10 ring-emerald-400/50 text-emerald-200'));
      outs.appendChild(metricCard('Time to value', 'Day 1', 'zap', 'bg-cyan-400/10 ring-1 ring-cyan-400/50 text-cyan-200'));
      outs.appendChild(metricCard('Change risk', 'Reduced', 'shield', 'bg-yellow/10 ring-1 ring-yellow/50 text-yellow-200'));

      safeLucide();
    }

    function hexTile(label) {
      const btn = el('button', { class: 'group relative isolate inline-flex items-center justify-center aspect-[1.1547] w-full rounded-xl focus:outline-none focus-visible:ring-2 focus-visible:ring-white/80', 'aria-label': label });

      const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
      svg.setAttribute('viewBox', '0 0 100 86.6');
      svg.setAttribute('class', 'absolute inset-0 w-full h-full');
      const poly = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
      poly.setAttribute('points', '50,0 100,25 100,61.6 50,86.6 0,61.6 0,25');
      poly.setAttribute('fill', '#7c3aed');
      poly.setAttribute('fill-opacity', '0.15');
      poly.setAttribute('stroke', '#7c3aed');
      poly.setAttribute('stroke-opacity', '0.55');
      poly.setAttribute('stroke-width', '2');
      svg.appendChild(poly);

      const inner = el('div', { class: 'relative z-10 flex flex-col items-center justify-center text-center px-1' }, [
        icon('hexagon', 'h-4 w-4 mb-1'),
        el('div', { class: 'text-[11px] font-medium' }, label),
        el('span', { class: 'mt-1 text-[10px] rounded-full px-1.5 py-0.5 ring-1 ring-white/20 bg-white/10' }, 'Queued')
      ]);

      btn.appendChild(svg);
      btn.appendChild(inner);

      btn.addEventListener('click', () => cycleTile(inner));
      return btn;
    }
    function cycleTile(inner) {
      const badge = inner.querySelector('span');
      const i = inner.querySelector('i');
      const states = ['Queued', 'Provisioning', 'Patched', 'Updated'];
      const icons  = ['hexagon', 'download', 'shield-check', 'refresh-ccw'];
      const next = (states.indexOf(badge.textContent) + 1) % states.length;
      badge.textContent = states[next];
      i.setAttribute('data-lucide', icons[next]);
      safeLucide();
    }
    function workspaceDemo() {
      if (STATE.reducedMotion) return;
      // Animate rings
      document.querySelectorAll('#rings > div > div > div').forEach((bar, i) => {
        bar.style.width = '0%';
        setTimeout(() => { bar.style.transition = 'width 900ms ease'; bar.style.width = ['70%','86%','95%'][i]; }, 100 * i);
      });
      // Walk tiles through states
      Array.from(document.querySelectorAll('#hexgrid button')).forEach((btn, i) =>
        setTimeout(() => btn.click(), 90 * i)
      );
      const outs = field('outcomes');
      outs.classList.add('shadow-glowPurple');
      setTimeout(() => outs.classList.remove('shadow-glowPurple'), 1200);
    }

    // ========= VIEW: IMPACT & ROI =========
    function renderImpact() {
      const view = el('section', { class: 'space-y-5', 'aria-label': 'Impact & ROI' });

      // KPIs
      const r = calcResults();
      view.appendChild(el('div', { class: 'grid md:grid-cols-4 gap-3' }, [
        kpi('Hours saved / mo', r.hoursSavedPerMonth),
        kpi('$ saved / yr', `$${fmt(r.dollarsSavedPerYear)}`, 'banknote'),
        kpi('ROI', `${fmt(r.roiPct)}%`, 'percent'),
        kpi('Tickets / mo', r.ticketsPerMonth, 'rocket')
      ]));

      // Assumptions + Results
      const wrap = el('div', { class: 'rounded-3xl ring-1 ring-line bg-white/5 p-4 md:p-5 grid lg:grid-cols-2 gap-6' });

      // Form
      const form = el('div', {});
      form.appendChild(el('h3', { class: 'font-bold text-lg mb-3 flex items-center gap-2' }, [icon('sliders-horizontal'), 'Assumptions']));
      form.appendChild(numberInput('# users', 'users', STATE.roi.users));
      form.appendChild(numberInput('Tickets per user / mo', 'ticketsPerUserPerMonth', STATE.roi.ticketsPerUserPerMonth, '0.001'));
      form.appendChild(numberInput('Avg handle (mins)', 'avgHandleMins', STATE.roi.avgHandleMins));
      form.appendChild(numberInput('Loaded cost ($/hr)', 'loadedCostPerHour', STATE.roi.loadedCostPerHour));
      form.appendChild(numberInput('Recast annual cost ($)', 'recastAnnualCost', STATE.roi.recastAnnualCost));
      form.appendChild(el('p', { class: 'mt-2 text-[13px] text-textDim' }, 'Values are examples. Replace with your data for accurate estimates.'));
      wrap.appendChild(form);

      // Results
      const res = el('div', { class: 'space-y-4' });
      res.appendChild(el('h3', { class: 'font-bold text-lg flex items-center gap-2' }, [icon('receipt'), 'Results']));
      const box = el('div', { id: 'resultsBox', class: 'rounded-2xl ring-1 ring-line bg-white/5 p-4 space-y-2' });
      res.appendChild(box);

      const actions = el('div', { class: 'flex items-center gap-2' }, [
        primaryBtn('Copy executive one-pager', 'clipboard-copy', async () => {
          const rr = calcResults();
          const text = [
            'Recast + Microsoft Intune — Executive Summary',
            '',
            'Why application management drives Intune adoption:',
            '- Apps are the #1 bottleneck to migration and ongoing management.',
            '- Recast delivers and patches applications automatically into Intune with rings and proof.',
            '- Result: faster rollouts, higher compliance, less risk, and measurable time savings.',
            '',
            'Impact (illustrative):',
            `• Hours saved / month: ${fmt(rr.hoursSavedPerMonth)}`,
            `• $ saved / year: $${fmt(rr.dollarsSavedPerYear)}`,
            `• ROI: ${fmt(rr.roiPct)}%`,
            `• Tickets / month: ${fmt(rr.ticketsPerMonth)}`,
            '',
            'Assumptions:',
            JSON.stringify(STATE.roi, null, 2)
          ].join('\n');
          try {
            if (navigator.clipboard && window.isSecureContext) {
              await navigator.clipboard.writeText(text);
            } else {
              const ta = el('textarea', { style: 'position:absolute;left:-9999px;top:0;' });
              ta.value = text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove();
            }
            toast('Copied summary to clipboard.');
          } catch { toast('Copy failed.'); }
        }, 'bg-yellow text-black'),
        secondaryBtn('Reset', 'refresh-ccw', () => { STATE.roi = { users: 5000, ticketsPerUserPerMonth: 0.035, avgHandleMins: 18, loadedCostPerHour: 85, recastAnnualCost: 120000 }; render(); })
      ]);
      res.appendChild(actions);

      wrap.appendChild(res);
      view.appendChild(wrap);

      updateResultsBox();
      return view;
    }

    function kpi(label, value, iconName = 'timer') {
      return el('div', { class: 'rounded-2xl ring-1 ring-line bg-white/5 px-4 py-3 flex items-center justify-between' }, [
        el('div', { class: 'flex items-center gap-2' }, [icon(iconName), el('span', { class: 'text-sm text-slate-300' }, label)]),
        el('span', { class: 'text-base font-semibold' }, typeof value === 'number' ? fmt(value) : value)
      ]);
    }
    function numberInput(label, key, value, step = '1') {
      const id = `f_${key}`;
      const row = el('div', { class: 'mb-2' }, [
        el('label', { for: id, class: 'block text-[13px] text-slate-300 mb-1' }, label),
        el('input', { id, type: 'number', step, value, class: 'w-full rounded-xl bg-panel ring-1 ring-line px-3 py-2 text-sm outline-none focus-visible:ring-2 focus-visible:ring-purple' })
      ]);
      setTimeout(() => {
        const input = row.querySelector('input');
        input.addEventListener('input', () => {
          const v = Number(input.value);
          if (Number.isFinite(v)) { STATE.roi[key] = v; updateResultsBox(); }
        });
      }, 0);
      return row;
    }
    function calcResults() {
      const r = STATE.roi;
      const userHours = (STATE.metrics.minutesPerUser * r.users) / 60;
      const ticketsPerMonth = Math.round(r.users * r.ticketsPerUserPerMonth);
      const hoursFromTickets = (ticketsPerMonth * r.avgHandleMins) / 60 * 0.3; // assume 30% avoided by automation
      const hoursSavedPerMonth = Math.round(userHours + hoursFromTickets + STATE.metrics.packagingHours);
      const dollarsSavedPerMonth = Math.round(hoursSavedPerMonth * r.loadedCostPerHour);
      const dollarsSavedPerYear = dollarsSavedPerMonth * 12;
      const netBenefit = dollarsSavedPerYear - r.recastAnnualCost;
      const roiPct = Math.round((netBenefit / r.recastAnnualCost) * 100);
      return { hoursSavedPerMonth, dollarsSavedPerMonth, dollarsSavedPerYear, netBenefit, roiPct, ticketsPerMonth };
    }
    function updateResultsBox() {
      const box = field('resultsBox'); if (!box) return;
      const r = calcResults();
      box.innerHTML = '';
      [
        ['Hours saved / month', fmt(r.hoursSavedPerMonth)],
        ['$ saved / month', `$${fmt(r.dollarsSavedPerMonth)}`],
        ['$ saved / year', `$${fmt(r.dollarsSavedPerYear)}`],
        ['Net benefit / year', `$${fmt(r.netBenefit)}`],
        ['ROI', `${fmt(r.roiPct)}%`],
        ['Equivalent IT FTEs freed', (r.hoursSavedPerMonth / 160).toFixed(2)]
      ].forEach(([k, v]) => {
        box.appendChild(el('div', { class: 'flex items-center justify-between rounded-xl bg-white/5 ring-1 ring-line px-3 py-2' }, [
          el('span', { class: 'text-sm text-slate-300' }, k),
          el('span', { class: 'text-sm font-semibold' }, v)
        ]));
      });
    }

    // ========= NAV & INIT =========
    function bindTabs() {
      document.querySelectorAll('nav#tabs .tab').forEach(btn => {
        btn.addEventListener('click', () => {
          STATE.activeTab = btn.dataset.tab;
          document.querySelectorAll('nav#tabs button span').forEach(s => s.classList.replace('bg-white/10', 'bg-white/5'));
          btn.querySelector('span').classList.replace('bg-white/5', 'bg-white/10');
          document.querySelectorAll('nav#tabs .tab').forEach(b => b.setAttribute('aria-selected', b === btn ? 'true' : 'false'));
          render();
        });
      });
    }
    function toast(msg) {
      const bar = el('div', { class: 'fixed bottom-4 left-1/2 -translate-x-1/2 z-50 rounded-xl bg-emerald-900/90 ring-1 ring-emerald-600 px-4 py-2 text-sm' }, msg);
      document.body.appendChild(bar);
      setTimeout(() => bar.remove(), 2200);
    }
    function checkCDNs() {
      let fail = false;
      if (typeof tailwind === 'undefined') fail = true;
      if (!window.lucide) fail = true;
      if (fail) field('cdn-banner').classList.remove('hidden');
    }

    document.addEventListener('DOMContentLoaded', () => {
      bindTabs();
      render();
      setTimeout(() => safeLucide(), 60);
      setTimeout(checkCDNs, 800);
    });
  </script>

  <style>
    .tab:focus-visible span { outline: 2px solid rgba(255,255,255,.75); outline-offset: 2px; }
  </style>
</body>
</html>
